<div class="container-fluid">
    <div class="row">
        <div class="col-sm-12">
            <app-breadcrumb
                [title]="getTitle.module | translate"
                [active_item]="getTitle.subModule | translate"
            ></app-breadcrumb>
            <div class="card">
                <div class="card-body">
                    <div *ngIf="!displayUrlErrorPage">
                        <ng-container
                            *ngIf="isNumber(demandPrice); else loading"
                        >
                            <div class="forms-feature-header">
                                <div>
                                    <h4>
                                        <b
                                            *ngIf="
                                                urlParamRef ===
                                                'mass-add-mobile-subscription'
                                            "
                                        >
                                            <span>{{
                                                'SIM_CARD_SUBSCRIPTION_ADD_ON_REQUEST_FORM'
                                                    | translate
                                            }}</span>
                                        </b>
                                        <b
                                            *ngIf="
                                                urlParamRef ===
                                                'simple-add-mobile-subscription'
                                            "
                                        >
                                            <span>{{
                                                'SIMPLE_SIM_CARD_SUBSCRIPTION_ADD_ON_REQUEST_FORM'
                                                    | translate
                                            }}</span>
                                        </b>

                                        <b
                                            *ngIf="
                                                urlParamRef ===
                                                'mass-add-importation'
                                            "
                                        >
                                            <span>{{
                                                'SIM_CARD_IMPORTATION_ADD_ON_REQUEST_FORM'
                                                    | translate
                                            }}</span>
                                        </b>
                                        <b
                                            *ngIf="
                                                urlParamRef ===
                                                'simple-add-importation'
                                            "
                                        >
                                            <span>{{
                                                'SIMPLE_SIM_CARD_IMPORTATION_ADD_ON_REQUEST_FORM'
                                                    | translate
                                            }}</span>
                                        </b>

                                        <b
                                            *ngIf="
                                                urlParamRef ===
                                                'mass-add-white-sim'
                                            "
                                        >
                                            <span>{{
                                                'WHITE_SIM_BULK_ADD_ON_FORM'
                                                    | translate
                                            }}</span>
                                        </b>
                                        <b
                                            *ngIf="
                                                urlParamRef ===
                                                'simple-add-white-sim'
                                            "
                                        >
                                            <span>{{
                                                'WHITE_SIM_SIMPLE_ADD_ON_FORM'
                                                    | translate
                                            }}</span>
                                        </b>
                                    </h4>
                                </div>
                                <div class="d-flex gap-3">
                                    <div>
                                        <p-button
                                            [label]="'SAVE' | translate"
                                            styleClass="p-button-success"
                                            [class.p-disabled]="
                                                formDemand.invalid
                                            "
                                            (click)="handleSaveDemand()"
                                        >
                                        </p-button>
                                    </div>
                                    <div>
                                        <p-button
                                            [label]="'CLOSE' | translate"
                                            (click)="onGoToBack()"
                                            styleClass="p-button-danger"
                                        >
                                        </p-button>
                                    </div>
                                </div>
                            </div>

                            <div style="margin-top: 3rem">
                                <div [formGroup]="formDemand">
                                    <!-- Le formulaire de demande de SIM blanche & d'importation de SIM ne dispose pas de ce fieldset -->
                                    <fieldset
                                        *ngIf="
                                            !urlParamRef.includes(
                                                'white-sim'
                                            ) &&
                                            !urlParamRef.includes('importation')
                                        "
                                    >
                                        <legend>
                                            <b>{{
                                                'STOCK_SOURCE_SIM_CARD'
                                                    | translate
                                            }}</b>
                                        </legend>
                                        <div
                                            class="row"
                                            style="
                                                padding-right: 0;
                                                padding-left: 3px;
                                                display: flex;
                                                gap: 4px;
                                                flex-wrap: nowrap;
                                            "
                                        >
                                            <div
                                                class="col-md-3 d-flex justify-content-around gap-2"
                                                style="
                                                    border: 1px solid #ced4da;
                                                    height: 3.6rem;
                                                    border-radius: 6px;
                                                "
                                            >
                                                <div
                                                    class="d-flex align-items-center justify-content-around gap-2 form-check form-check-inline p-0 m-0"
                                                >
                                                    <input
                                                        class="form-check-input"
                                                        type="radio"
                                                        name="source"
                                                        value="stock orange"
                                                        id="stock_orange"
                                                        formControlName="source"
                                                        #stock_orange
                                                        style="
                                                            width: 25px;
                                                            height: 25px;
                                                        "
                                                    />
                                                    <label
                                                        class="form-check-label fs-5"
                                                        for="stock_orange"
                                                        style="width: inherit"
                                                    >
                                                        <strong>{{
                                                            'ORANGE_STOCK'
                                                                | translate
                                                        }}</strong>
                                                    </label>
                                                </div>
                                                <div
                                                    class="d-flex align-items-center justify-content-around gap-2 form-check form-check-inline p-0 m-0"
                                                >
                                                    <input
                                                        class="form-check-input"
                                                        type="radio"
                                                        name="source"
                                                        value="stock local"
                                                        id="mon_stock"
                                                        formControlName="source"
                                                        #mon_stock
                                                        style="
                                                            width: 25px;
                                                            height: 25px;
                                                        "
                                                    />
                                                    <label
                                                        class="form-check-label fs-5"
                                                        for="mon_stock"
                                                    >
                                                        <strong>{{
                                                            'MY_STOCK'
                                                                | translate
                                                        }}</strong>
                                                    </label>
                                                </div>
                                            </div>
                                            <div
                                                class="col-md-9"
                                                style="padding-right: 10px"
                                                *ngIf="stock_orange.checked"
                                            >
                                                <input
                                                    type="text"
                                                    pInputText
                                                    [value]="
                                                        'ORANGE_WILL_PROVIDE_THE_SIM_CARDS'
                                                            | translate
                                                    "
                                                    disabled
                                                />
                                            </div>
                                            <div
                                                class="col-md-9"
                                                style="
                                                    padding-right: 10px;
                                                    display: flex;
                                                    flex-wrap: nowrap;
                                                    gap: 4px;
                                                "
                                                *ngIf="mon_stock.checked"
                                            >
                                                <input
                                                    type="text"
                                                    pInputText
                                                    disabled
                                                    [value]="
                                                        'THE_SUBSCRIPTION_WILL_BE_MADE_ON_THE_SIM_CARDS_IN_MY_POSSESSION'
                                                            | translate
                                                    "
                                                />
                                                <button
                                                    style="width: 15rem"
                                                    icon="pi pi-plus"
                                                    pButton
                                                    label="Prendre lots"
                                                    class="p-button-success"
                                                    (click)="showDialog()"
                                                ></button>
                                            </div>
                                        </div>
                                    </fieldset>

                                    <!-- <fieldset>
                                        <legend>
                                            <b>Demande</b>
                                        </legend>
                                        <div class="row">
                                            <div class="col-md-6">
                                                <div class="form-group">
                                                    <label><b>Montant de la
                                                            formule/SIM<span class="text-danger">*</span></b></label>
                                                    <input placeholder="Montant de la formule"
                                                        formControlName="montant_formule" type="number" pInputText />
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <label for="commentaire"><strong>Réçu paiement<span
                                                            class="text-danger">*</span></strong></label>
                                                <div
                                                    class="d-flex justify-content-center align-items-center container-button-telecharger">
                                                    <div>
                                                        <input type="file" style="
                                                            padding: 0.6rem;
                                                            border: 1px solid;
                                                            border-radius: 0.3rem;
                                                            color: #000;
                                                        " (change)="
                                                            onChangeFile(
                                                                $event.target
                                                                    .files
                                                            )
                                                        " accept="image/png,image/jpeg" />
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </fieldset> -->

                                    <fieldset
                                        *ngIf="
                                            !urlParamRef.includes(
                                                'white-sim'
                                            ) &&
                                            !urlParamRef.includes(
                                                'mobile-subscription'
                                            )
                                        "
                                    >
                                        <legend>
                                            <b>{{
                                                'SIM_IMPORTATION' | translate
                                            }}</b>
                                        </legend>
                                        <div class="row">
                                            <app-form-masse
                                                class="col-md-12 d-flex align-items-end"
                                                [fileModel]="fileModel"
                                                [excelFileIsCorrect]="
                                                    excelFileIsCorrect
                                                "
                                                (dataToSend)="
                                                    pushCurrentArrayForm($event)
                                                "
                                                [currentArrayHeaders]="
                                                    currentArrayHeaders
                                                "
                                                (downloadModel)="
                                                    onDownloadModel($event)
                                                "
                                                [formMasseLibelle]="
                                                    formMasseLibelle
                                                "
                                                [libelleFile]="libelleFile"
                                            >
                                            </app-form-masse>
                                        </div>
                                    </fieldset>

                                    <fieldset
                                        *ngIf="
                                            !urlParamRef.includes('importation')
                                        "
                                    >
                                        <legend>
                                            <strong>{{
                                                'INFORMATION_REQUEST'
                                                    | translate
                                            }}</strong>
                                        </legend>
                                        <div class="row">
                                            <div class="col-md">
                                                <div class="form-group">
                                                    <label
                                                        ><b>{{
                                                            'NUMBER' | translate
                                                        }}</b
                                                        ><span
                                                            class="text-danger"
                                                            >*</span
                                                        ></label
                                                    >
                                                    <input
                                                        placeholder="nombre"
                                                        formControlName="nb_demandes"
                                                        type="number"
                                                        pInputText
                                                        style="
                                                            font-size: 15px !important;
                                                        "
                                                    />
                                                </div>
                                            </div>
                                            <div
                                                *ngIf="
                                                    !urlParamRef.includes(
                                                        'white-sim'
                                                    )
                                                "
                                                class="col-md-2"
                                            >
                                                <div class="form-group">
                                                    <label
                                                        ><b
                                                            >{{
                                                                'USAGE'
                                                                    | translate
                                                            }}<span
                                                                class="text-danger"
                                                                >*</span
                                                            ></b
                                                        ></label
                                                    >
                                                    <p-dropdown
                                                        [options]="
                                                            listUsages$ | async
                                                        "
                                                        formControlName="usage_id"
                                                        optionLabel="nom_usage"
                                                        placeholder="usage"
                                                        optionValue="id"
                                                        [showClear]="true"
                                                    >
                                                    </p-dropdown>
                                                </div>
                                            </div>
                                            <div
                                                *ngIf="
                                                    !urlParamRef.includes(
                                                        'white-sim'
                                                    )
                                                "
                                                class="col-md-2"
                                            >
                                                <div class="form-group">
                                                    <label
                                                        ><b
                                                            >{{
                                                                'SUBSCRIPTION_FORMULA'
                                                                    | translate
                                                            }}<span
                                                                class="text-danger"
                                                                >*</span
                                                            ></b
                                                        ></label
                                                    >
                                                    <p-dropdown
                                                        [options]="
                                                            listFormulas$
                                                                | async
                                                        "
                                                        formControlName="formule_uuid"
                                                        optionLabel="nom"
                                                        [placeholder]="
                                                            'Formule destination'
                                                        "
                                                        [showClear]="true"
                                                        optionValue="uuid"
                                                    >
                                                    </p-dropdown>
                                                </div>
                                            </div>
                                            <div class="col-md">
                                                <div class="form-group">
                                                    <label
                                                        ><b
                                                            >{{
                                                                'PU' | translate
                                                            }}
                                                            (Fcfa)</b
                                                        ></label
                                                    >
                                                    <input
                                                        type="number"
                                                        pInputText
                                                        disabled
                                                        style="
                                                            font-size: 15px !important;
                                                        "
                                                        [value]="demandPrice"
                                                    />
                                                </div>
                                            </div>
                                            <div class="col-md">
                                                <div class="form-group">
                                                    <label
                                                        ><b
                                                            >{{
                                                                'NET_AMOUNT'
                                                                    | translate
                                                            }}
                                                            (Fcfa)</b
                                                        ></label
                                                    >
                                                    <input
                                                        formControlName="montant"
                                                        type="text"
                                                        pInputText
                                                        style="
                                                            font-size: 15px !important;
                                                        "
                                                    />
                                                </div>
                                            </div>
                                            <div class="col-md-3">
                                                <div class="form-group">
                                                    <label
                                                        ><b
                                                            >{{
                                                                'MAIL_OR_DOCUMENT'
                                                                    | translate
                                                            }}<span
                                                                class="text-danger"
                                                                >*</span
                                                            ></b
                                                        ></label
                                                    >
                                                    <input
                                                        type="file"
                                                        style="
                                                            padding: 0.6rem;
                                                            border: 1px solid
                                                                #000;
                                                            border-radius: 0.3rem;
                                                            color: #000;
                                                        "
                                                        (change)="
                                                            onChangeFile(
                                                                $event.target
                                                                    .files
                                                            )
                                                        "
                                                        accept="image/png,image/jpeg"
                                                    />
                                                </div>
                                            </div>
                                        </div>
                                    </fieldset>

                                    <!-- /*************************************************activation-en-simple*****************************************/ -->

                                    <fieldset
                                        *ngIf="
                                            urlParamRef ===
                                            'simple-add-mobile-subscription'
                                        "
                                    >
                                        <legend>
                                            <b>{{
                                                'ALLOCATION_INFORMATION'
                                                    | translate
                                            }}</b>
                                        </legend>
                                        <div class="row">
                                            <div class="col-md-4">
                                                <div class="form-group">
                                                    <label
                                                        ><b>{{
                                                            firstLevelLibel
                                                        }}</b></label
                                                    >
                                                    <p-dropdown
                                                        formControlName="niveau_un_uuid"
                                                        [options]="
                                                            listFirstLevel$
                                                                | async
                                                        "
                                                        optionValue="uuid"
                                                        optionLabel="nom"
                                                        filterBy="nom"
                                                        [showClear]="true"
                                                        [filter]="true"
                                                        placeholder="{{
                                                            'SELECT' | translate
                                                        }} {{
                                                            firstLevelLibel
                                                        }}"
                                                        emptyFilterMessage="{{
                                                            'NO_MATCH'
                                                                | translate
                                                        }}"
                                                        emptyMessage="{{
                                                            'NO_DATA_FOUND'
                                                                | translate
                                                        }}"
                                                    >
                                                    </p-dropdown>
                                                </div>
                                            </div>

                                            <div class="col-md-2">
                                                <label
                                                    ><b>{{
                                                        secondLevelLibel
                                                    }}</b></label
                                                >
                                                <p-dropdown
                                                    formControlName="niveau_deux_uuid"
                                                    [options]="
                                                        listSecondLevel$ | async
                                                    "
                                                    optionValue="uuid"
                                                    optionLabel="nom"
                                                    filterBy="nom"
                                                    [showClear]="true"
                                                    [filter]="true"
                                                    placeholder="{{
                                                        'SELECT' | translate
                                                    }} {{ secondLevelLibel }}"
                                                    emptyFilterMessage="{{
                                                        'NO_MATCH' | translate
                                                    }}"
                                                    emptyMessage="{{
                                                        'NO_DATA_FOUND'
                                                            | translate
                                                    }}"
                                                >
                                                </p-dropdown>
                                            </div>
                                            <div class="col-md-4">
                                                <div class="form-group">
                                                    <label
                                                        ><b>{{
                                                            thirdLevelLibel
                                                        }}</b></label
                                                    >
                                                    <p-dropdown
                                                        [options]="
                                                            listThirdLevel$
                                                                | async
                                                        "
                                                        formControlName="niveau_trois_uuid"
                                                        optionLabel="nom"
                                                        placeholder="{{
                                                            'SELECT' | translate
                                                        }} {{
                                                            thirdLevelLibel
                                                        }}"
                                                        [filter]="true"
                                                        filterBy="nom"
                                                        optionValue="uuid"
                                                        [showClear]="true"
                                                    >
                                                    </p-dropdown>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-md-4">
                                                <div class="form-group">
                                                    <label
                                                        ><b
                                                            >{{
                                                                'NAME_LOCATION'
                                                                    | translate
                                                            }}<span
                                                                class="text-danger"
                                                                >*</span
                                                            ></b
                                                        ></label
                                                    >
                                                    <input
                                                        type="text"
                                                        formControlName="point_emplacement"
                                                        pInputText
                                                    />
                                                </div>
                                            </div>
                                            <div class="col-md-4">
                                                <div class="form-group">
                                                    <label
                                                        ><b>{{
                                                            'EMAIL_ADDRESS'
                                                                | translate
                                                        }}</b></label
                                                    >
                                                    <input
                                                        type="text"
                                                        formControlName="adresse_email"
                                                        pInputText
                                                    />
                                                </div>
                                            </div>
                                            <div class="col-md-4">
                                                <div class="form-group">
                                                    <label
                                                        ><b
                                                            >{{
                                                                'GEOGRAPHICAL_ADDRESS'
                                                                    | translate
                                                            }}<span
                                                                class="text-danger"
                                                                >*</span
                                                            ></b
                                                        ></label
                                                    >
                                                    <input
                                                        type="text"
                                                        formControlName="adresse_geographique"
                                                        pInputText
                                                    />
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-md-6">
                                                <div class="form-group">
                                                    <label
                                                        ><b>{{
                                                            'LATITUDE'
                                                                | translate
                                                        }}</b></label
                                                    >
                                                    <input
                                                        type="text"
                                                        formControlName="latitude"
                                                        pInputText
                                                    />
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="form-group">
                                                    <label
                                                        ><b>{{
                                                            'LONGITUDE'
                                                                | translate
                                                        }}</b></label
                                                    >
                                                    <input
                                                        type="text"
                                                        formControlName="longitude"
                                                        pInputText
                                                    />
                                                </div>
                                            </div>
                                        </div>
                                    </fieldset>

                                    <fieldset>
                                        <legend>
                                            <b>{{
                                                'REQUEST_DESCRIPTION'
                                                    | translate
                                            }}</b>
                                        </legend>
                                        <div class="row">
                                            <div
                                                class="col-md-12 d-flex align-items-end"
                                            >
                                                <input
                                                    type="text"
                                                    formControlName="description"
                                                    pInputText
                                                    [ngStyle]="{
                                                        'border-color':
                                                            formDemand.get(
                                                                'description'
                                                            )?.invalid
                                                                ? 'red'
                                                                : ''
                                                    }"
                                                    placeholder="{{
                                                        'COMMENT' | translate
                                                    }}..."
                                                />
                                            </div>
                                        </div>
                                    </fieldset>
                                    <div
                                        class="form-check pt-3"
                                        *ngIf="
                                            !urlParamRef.includes(
                                                'white-sim'
                                            ) &&
                                            !urlParamRef.includes(
                                                'mobile-subscription'
                                            )
                                        "
                                    >
                                        <input
                                            class="form-check-input"
                                            type="radio"
                                            [value]="true"
                                            name="confirmation_contrat"
                                            id="confirmOrange"
                                            formControlName="confirmation_contrat"
                                            style="transform: scale(2)"
                                            required
                                        />
                                        <label
                                            style="margin-left: 10px"
                                            class="form-check-label"
                                            for="confirmOrange"
                                        >
                                            JE CONFIRME QUE LES NUMÉROS IMPORTÉS
                                            FONT L’OBJET DE CONTRAT AVEC ORANGE
                                        </label>
                                    </div>
                                </div>
                                <div class="forms-feature-footer">
                                    <p-button
                                        [label]="'SAVE' | translate"
                                        [class.p-disabled]="formDemand.invalid"
                                        styleClass="p-button-success"
                                        (click)="handleSaveDemand()"
                                    >
                                    </p-button>
                                </div>
                            </div>
                        </ng-container>
                        <ng-template #loading>
                            <div
                                class="d-flex justify-content-center align-items-center"
                                style="height: 100vh"
                            >
                                <p-progressSpinner
                                    ariaLabel="loading"
                                ></p-progressSpinner>
                            </div>
                        </ng-template>
                    </div>

                    <div *ngIf="displayUrlErrorPage">
                        <div>
                            <div class="d-flex justify-content-end">
                                <p-button
                                    [label]="'CLOSE' | translate"
                                    styleClass="p-button-danger"
                                    (click)="onGoToBack()"
                                ></p-button>
                            </div>
                        </div>
                        <div
                            class="d-flex justify-content-center align-items-center text-danger"
                        >
                            {{ 'NO_DATA_FOUND' | translate }}
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="card">
    <p-dialog
        [resizable]="false"
        [modal]="true"
        header="{{ 'LIST_OF_AVAILABLE_WHITE_SIM_BUNDLES' | translate }} [ {{
            totalLotWhiteSimCardAvailable
        }} ]"
        [maximizable]="true"
        appendTo="body"
        id="dialogHeaderTableWhiteSimCard"
        [(visible)]="whiteSimCardDialogVisible"
        [style]="{ width: '60vw' }"
    >
        <!-- /*************************************************Modal mass => traitement de la lste des cartes SIM disponibles***********************************************/ -->
        <ng-container *ngIf="urlParamRef === 'mass-add-mobile-subscription'">
            <p-table
                editMode="row"
                dataKey="id"
                #dt
                [value]="listWhiteSimCardAvailable"
                [scrollable]="true"
                scrollHeight="flex"
                [paginator]="true"
                [rows]="5"
                selectionMode="multiple"
                [(selection)]="globalWhiteSimCardEditRow"
                [globalFilterFields]="table_mass_demand.globalFilterFields"
                responsiveLayout="scroll"
                scrollable="true"
                scrollHeight="flex"
                width="100%"
                class="responsive-claims-table"
            >
                <ng-template pTemplate="caption">
                    <div class="d-flex justify-content-end mt-3">
                        <app-search-table [dt]="dt"></app-search-table>
                    </div>
                </ng-template>

                <ng-template pTemplate="header">
                    <tr>
                        <th
                            *ngFor="let col of table_mass_demand.cols"
                            [class]="col.class"
                            [ngStyle]="{ width: col.width }"
                        >
                            <ng-container [ngSwitch]="col.header">
                                <ng-container *ngSwitchCase="'Référence'">
                                    {{ 'NUMBER_REFERENCE' | translate }}
                                </ng-container>
                                <ng-container *ngSwitchCase="'SIM disponibles'">
                                    {{ 'SIM' | translate }}&nbsp;{{
                                        'AVAILABLE' | translate
                                    }}
                                </ng-container>
                                <ng-container *ngSwitchCase="'Sélection'">
                                    {{ 'SELECTION' | translate }}
                                </ng-container>
                                <ng-container *ngSwitchCase="'Actions'">
                                    {{ 'ACTIONS' | translate }}
                                </ng-container>
                                <ng-container *ngSwitchDefault>
                                    {{ col.header }}
                                </ng-container>
                            </ng-container>
                        </th>
                    </tr>
                </ng-template>
                <ng-template
                    pTemplate="body"
                    let-rowIndex="rowIndex"
                    let-lot
                    let-editing="editing"
                >
                    <tr
                        [pEditableRow]="lot"
                        [editableRow]="editableRowIndex === rowIndex"
                    >
                        <td
                            *ngFor="let col of table_mass_demand.cols"
                            [ngStyle]="{ width: col.width }"
                            [ngClass]="{ 'col.class': true }"
                        >
                            <ng-container [ngSwitch]="col.header">
                                <ng-container *ngSwitchCase="'#'">
                                    {{ rowIndex + 1 }}
                                </ng-container>
                                <ng-container *ngSwitchCase="'Référence'">
                                    <span
                                        (click)="copyToClipboard(lot?.[col.field])"
                                    >
                                        {{ lot?.[col.field] }}
                                    </span>
                                </ng-container>
                                <ng-container *ngSwitchCase="'Sélection'">
                                    <p-cellEditor>
                                        <ng-template pTemplate="input">
                                            <div class="d-flex gap-2">
                                                <input
                                                    pInputText
                                                    type="number"
                                                    [(ngModel)]="
                                                        lot.selected_nb_restants
                                                    "
                                                />
                                            </div>
                                        </ng-template>
                                        <ng-template pTemplate="output">
                                            {{ lot?.selected_nb_restants || 0 }}
                                        </ng-template>
                                    </p-cellEditor>
                                </ng-container>
                                <ng-container *ngSwitchCase="'Actions'">
                                    <button
                                        *ngIf="!editing"
                                        pButton
                                        pRipple
                                        type="button"
                                        pInitEditableRow
                                        [pTooltip]="'MODIFY' | translate"
                                        tooltipPosition="top"
                                        icon="pi pi-pencil"
                                        (click)="editRow(lot, rowIndex)"
                                        class="p-button-secondary"
                                    ></button>

                                    <button
                                        *ngIf="editing"
                                        pButton
                                        pRipple
                                        type="button"
                                        pSaveEditableRow
                                        [pTooltip]="'SAVE' | translate"
                                        tooltipPosition="top"
                                        icon="pi pi-check"
                                        (click)="saveRowEdit(lot)"
                                        class="p-button-success"
                                    ></button>

                                    <button
                                        *ngIf="editing"
                                        pButton
                                        pRipple
                                        type="button"
                                        pCancelEditableRow
                                        pTooltip="'CLOSE' | translate"
                                        tooltipPosition="top"
                                        icon="pi pi-times"
                                        (click)="cancelRowEdit(lot, rowIndex)"
                                        class="p-button-danger"
                                        style="margin-left: 1rem"
                                    ></button>
                                </ng-container>
                                <ng-container *ngSwitchDefault>
                                    {{lot?.[col.field]}}
                                </ng-container>
                            </ng-container>
                        </td>
                    </tr>
                </ng-template>
                <!-- <ng-template pTemplate="body" let-rowIndex="rowIndex" let-customer let-editing="editing">
                    <tr [pEditableRow]="customer" [editableRow]="editableRowIndex === rowIndex">
                        <td style="display: flex; justify-content: center; max-width: 4rem;">
                            {{ rowIndex + 1 }}
                        </td>

                        <td style="display: flex; justify-content: center;">{{ customer?.numero_demande }}</td>

                        <td style="display: flex; justify-content: center;">{{ customer?.nb_restants }}</td>

                        <td style="display: flex; justify-content: center;">
                            <p-cellEditor>
                                <ng-template pTemplate="input">
                                    <div class="d-flex gap-2">
                                        <input pInputText type="number" [(ngModel)]="customer.selected_nb_restants" />
                                    </div>
                                </ng-template>
                                <ng-template pTemplate="output">
                                    {{ customer?.selected_nb_restants || 0 }}
                                </ng-template>
                            </p-cellEditor>
                        </td>

                        <td class="td-actions">

                            <button *ngIf="!editing" pButton pRipple type="button" pInitEditableRow pTooltip="Modifier"
                                tooltipPosition="top" icon="pi pi-pencil" (click)="editRow(customer, rowIndex)"
                                class="p-button-secondary"></button>

                            <button *ngIf="editing" pButton pRipple type="button" pSaveEditableRow
                                pTooltip="Sauvegarder" tooltipPosition="top" icon="pi pi-check"
                                (click)="saveRowEdit(customer)" class="p-button-success"></button>

                            <button *ngIf="editing" pButton pRipple type="button" pCancelEditableRow pTooltip="Fermer"
                                tooltipPosition="top" icon="pi pi-times" (click)="cancelRowEdit(customer, rowIndex)"
                                class="p-button-danger" style="margin-left: 1rem"></button>
                        </td>
                    </tr>
                </ng-template> -->
            </p-table>
            <div class="d-flex justify-content-between align-items-center mt-3">
                <p class="fs-4 mb-0">
                    <b
                        >{{ 'NUMBER_OF_ELEMENTS_SELECTED' | translate }} [
                        <span
                            >{{ 'LOT' | translate }}&nbsp;:&nbsp;{{
                                globalWhiteSimCardEditRow.length || 0
                            }}</span
                        >&nbsp;|&nbsp;<span
                            >{{ 'SIM' | translate }}&nbsp;:&nbsp;{{
                                totalWhiteSimCardSelected || 0
                            }}</span
                        >
                        ]</b
                    >
                </p>
                <button
                    pButton
                    label="Valider"
                    class="p-button-success"
                    [disabled]="totalWhiteSimCardSelected <= 0"
                    (click)="HandleSaveLotWhiteSimCardSelected()"
                ></button>
            </div>
        </ng-container>

        <!-- /*************************************************Modal simple => traitement de la lste des cartes SIM disponibles***********************************************/ -->

        <ng-container *ngIf="urlParamRef === 'simple-add-mobile-subscription'">
            <p-table
                #dt
                [value]="listWhiteSimCardAvailable"
                [scrollable]="true"
                scrollHeight="flex"
                [paginator]="true"
                [rows]="5"
                selectionMode="single"
                dataKey="id"
                [(selection)]="selectedLotWhiteSimCardAvailable"
                [globalFilterFields]="table_simple_demand.globalFilterFields"
                responsiveLayout="scroll"
                scrollable="true"
                scrollHeight="flex"
                width="100%"
                class="responsive-claims-table"
            >
                <ng-template pTemplate="caption">
                    <div class="d-flex justify-content-end mt-3">
                        <app-search-table [dt]="dt"></app-search-table>
                    </div>
                </ng-template>

                <ng-template pTemplate="header">
                    <tr>
                        <th
                            *ngFor="let col of table_simple_demand.cols"
                            [class]="col.class"
                            [ngStyle]="{ width: col.width }"
                        >
                            <ng-container [ngSwitch]="col.header">
                                <ng-container *ngSwitchCase="'Référence'">
                                    {{ 'NUMBER_REFERENCE' | translate }}
                                </ng-container>
                                <ng-container *ngSwitchCase="'SIM disponibles'">
                                    {{ 'SIM' | translate }}&nbsp;{{
                                        'AVAILABLE' | translate
                                    }}
                                </ng-container>
                                <ng-container *ngSwitchCase="'Actions'">
                                    <div
                                        style="
                                            display: flex;
                                            justify-content: center;
                                        "
                                    >
                                        <p-tableHeaderCheckbox></p-tableHeaderCheckbox>
                                    </div>
                                </ng-container>
                                <ng-container *ngSwitchDefault>
                                    {{ col.header }}
                                </ng-container>
                            </ng-container>
                        </th>
                        <!-- <th style="display: flex; justify-content: center; max-width: 4rem;">
                            
                        </th> -->
                    </tr>
                </ng-template>

                <ng-template pTemplate="body" let-rowIndex="rowIndex" let-lot>
                    <tr [pSelectableRow]="lot">
                        <td
                            *ngFor="let col of table.cols"
                            [class]="col.class"
                            [ngStyle]="{ width: col.width }"
                        >
                            <ng-container [ngSwitch]="col.header">
                                <ng-container *ngSwitchCase="'#'">
                                    {{ rowIndex + 1 }}
                                </ng-container>
                                <ng-container *ngSwitchCase="'Référence'">
                                    <span
                                        (click)="copyToClipboard(lot?.[col.field])"
                                    >
                                        {{ lot?.[col.field] }}
                                    </span>
                                </ng-container>
                                <ng-container *ngSwitchCase="'Actions'">
                                    <div
                                        style="
                                            display: flex;
                                            justify-content: center;
                                        "
                                    >
                                        <p-tableCheckbox
                                            [value]="lot"
                                        ></p-tableCheckbox>
                                    </div>
                                </ng-container>
                                <ng-container *ngSwitchDefault>
                                    {{lot?.[col.field]}}
                                </ng-container>
                            </ng-container>
                        </td>
                    </tr>
                </ng-template>
            </p-table>
            <div class="d-flex justify-content-end align-items-center mt-3">
                <button
                    pButton
                    [label]="'VALIDATE' | translate"
                    class="p-button-success"
                    (click)="HandleSaveLotSimple()"
                    [disabled]="
                        !selectedLotWhiteSimCardAvailable ||
                        !selectedLotWhiteSimCardAvailable.length
                    "
                ></button>
            </div>
        </ng-container>
    </p-dialog>
</div>
