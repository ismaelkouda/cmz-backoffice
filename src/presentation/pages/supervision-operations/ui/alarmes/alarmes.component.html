<div class="container-fluid" [ngStyle]="{ 'margin-top': '1%' }" xmlns="http://www.w3.org/1999/html">
  <app-breadcrumb [title]="'Suivi des opérations'" [active_item]="'Statuts'"></app-breadcrumb>
  <div class="row">
    <div class="col-lg-3 col-xl-3" [ngStyle]="{ 'max-width': '17%' }">
      <div class="card" [ngStyle]="{ width: '300px' }">
        <div class="card-body" [ngStyle]="{ 'margin-top': '-1.4%', padding: '0' }">
          <ul class="list-group">
            <li [ngClass]="filterStatus === typeAchat? 'active': 'bg_light_green'" (click)="filterService(typeAchat)"
              class="list-group-item cursor-pointer">
              {{HandleFormatTitle('achat-service')}} ({{mappingResponse('commande_produit')?.length}})
            </li>
            <li [ngClass]="filterStatus === typeActivation? 'active': 'bg_light_green'"
              (click)="filterService(typeActivation)" class="list-group-item cursor-pointer">
              {{HandleFormatTitle('activation')}} ({{mappingResponse('demande_activation')?.length}})
            </li>
            <li [ngClass]="filterStatus === typeChangement? 'active': 'bg_light_green'"
              (click)="filterService(typeChangement)" class="list-group-item cursor-pointer">
              {{HandleFormatTitle('swap')}} ({{mappingResponse('swap')?.length}})
            </li>
            <li [ngClass]=" filterStatus === typeSuspension? 'active': 'bg_light_green'"
              (click)="filterService(typeSuspension)" class="list-group-item cursor-pointer">
              {{HandleFormatTitle('suspension')}} ({{mappingResponse('suspension')?.length}})
            </li>
            <li [ngClass]="filterStatus === typeResiliation? 'active': 'bg_light_green'"
              (click)="filterService(typeResiliation)" class="list-group-item cursor-pointer">
              {{HandleFormatTitle('resiliation')}} ({{mappingResponse('resiliation')?.length}})
            </li>
            <li [ngClass]="filterStatus === typeVolume? 'active': 'bg_light_green'" (click)="filterService(typeVolume)"
              class="list-group-item cursor-pointer">
              {{HandleFormatTitle('volume-data')}} ({{mappingResponse('volume_data')?.length}})
            </li>
            <li [ngClass]="filterStatus === typeProvisionning? 'active': 'bg_light_green'"
              (click)="filterService(typeProvisionning)" class="list-group-item cursor-pointer">
              {{HandleFormatTitle('provisionning')}} ({{mappingResponse('provisionning')?.length}})
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="col-lg-9 col-xl-9">
      <div class="card" [ngStyle]="{ 'border-radius': '15px', width: '1530px' }">
        <div class="card-body p-3">
          <p-table #dtransaction [value]="mappingResponse(filterStatus)" [rows]="10" [paginator]="true"
            [globalFilterFields]="[
                  'demandeur',
                  'erreurs',
                ]" responsiveLayout="scroll" [rowHover]="true" dataKey="id"
            currentPageReportTemplate="Affichage de {first} à {last} des {totalRecords} données"
            [showCurrentPageReport]="true">
            <ng-template pTemplate="caption">
              <div style="display: flex;justify-content: space-between;">
                <div>
                  <div class="pt-2">
                    <h4>
                      <b>
                        Catégorie de transaction - {{ HandleFormatSecondTitle(filterStatus) }}
                      </b>
                    </h4>
                  </div>
                </div>
                <div>
                  <form class="d-flex">
                    <div class="pull-right">
                      <span class="p-input-icon-left">
                        <i class="pi pi-search"></i>
                        <input pInputText type="text"
                          (input)="dtransaction.filterGlobal($event.target.value,'contains')"
                          placeholder="Recherche..." />
                      </span>
                    </div>
                  </form>
                </div>
              </div>
            </ng-template>
            <br />
            <ng-template pTemplate="header">
              <tr>
                <th>#</th>
                <th> Date/Heure </th>
                <th> N° Transaction </th>
                <th [ngStyle]="{ width: '200px' }"> Demandeur </th>
                <th> # Erreurs </th>
                <th [style]="{width: '4rem'}">Actions</th>
              </tr>
            </ng-template>
            <ng-template pTemplate="body" let-operation let-i="rowIndex">
              <tr>
                <td style="text-align: center">{{ i + 1 }}</td>
                <td>{{ operation.date_debut }}</td>
                <td> {{ operation.transaction }} </td>
                <td style="text-align: center">{{operation.nom_demandeur}} {{operation.prenoms_demandeur}}</td>
                <td style="text-align: center">{{operation.erreurs_count || 'N/A'}}</td>
                <td style="text-align: center">
                  <button pButton pRipple icon="pi pi-eye" class="p-button-dark" pTooltip="Voir"
                    tooltipPosition="top"></button>
                </td>
              </tr>
            </ng-template>
          </p-table>
        </div>
      </div>
    </div>
  </div>
</div>