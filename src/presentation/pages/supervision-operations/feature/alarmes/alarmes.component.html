<div class="container-fluid" [ngStyle]="{ 'margin-top': '1%' }" xmlns="http://www.w3.org/1999/html">
  <app-breadcrumb [title]="'Suivi des opérations'" [active_item]="'Statuts'"></app-breadcrumb>
  <div class="row">
    <div class="col-lg-3 col-xl-3" [ngStyle]="{ 'max-width': '17%' }">
      <div class="card" [ngStyle]="{ width: '300px' }">
        <div class="card-body" [ngStyle]="{ 'margin-top': '-1.4%', padding: '0' }">
          <ul class="list-group">
            <li [ngClass]="filterStatus === typeAchat? 'active': 'bg_light_green'" (click)="filterService(typeAchat)"
              class="list-group-item cursor-pointer" style="font-size: 16px !important">
              {{typeAchat}} ({{dataSource.length}})
            </li>
            <li [ngClass]="filterStatus === typeActivation? 'active': 'bg_light_green'"
              (click)="filterService(typeActivation)" class="list-group-item cursor-pointer"
              style="font-size: 16px !important">
              {{typeActivation}} ({{parametresListe.length}})
            </li>
            <li [ngClass]="filterStatus === typeChangement? 'active': 'bg_light_green'"
              (click)="filterService(typeChangement)" class="list-group-item cursor-pointer"
              style="font-size: 16px !important">
              {{typeChangement}} ({{synchroListe.length}})
            </li>
            <li [ngClass]=" filterStatus === typeSupervision? 'active': 'bg_light_green'"
              (click)="filterService(typeSupervision)" class="list-group-item cursor-pointer"
              style="font-size: 16px !important">
              {{typeSupervision}} ({{activationsListe.length}})
            </li>
            <li [ngClass]="filterStatus === typeResiliation? 'active': 'bg_light_green'"
              (click)="filterService(typeResiliation)" class="list-group-item cursor-pointer"
              style="font-size: 16px !important">
              {{typeResiliation}} ({{securitesListe.length}})
            </li>
            <li [ngClass]="filterStatus === typeVolume? 'active': 'bg_light_green'" (click)="filterService(typeVolume)"
              class="list-group-item cursor-pointer" style="font-size: 16px !important">
              {{typeVolume}} ({{securitesListe.length}})
            </li>
            <li [ngClass]="filterStatus === typeLigne? 'active': 'bg_light_green'" (click)="filterService(typeLigne)"
              class="list-group-item cursor-pointer" style="font-size: 16px !important">
              {{typeLigne}} ({{securitesListe.length}})
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="col-lg-9 col-xl-9">
      <div class="card" [ngStyle]="{ 'border-radius': '15px', width: '1530px' }">
        <div class="card-body p-3">
          <p-table #dtransaction [value]="listOperations" [rows]="10" [paginator]="true" [globalFilterFields]="[
                  'date',
                  'num_transaction',
                  'type_operation',
                  'operation',
                  'demandeur',
                  'erreurs',
                  'statut'
                ]" responsiveLayout="scroll" [rowHover]="true" dataKey="id"
            currentPageReportTemplate="Affichage de {first} à {last} des {totalRecords} données"
            [showCurrentPageReport]="true">
            <ng-template pTemplate="caption">
              <div style="display: flex;justify-content: space-between;">
                <div>
                  <div class="pt-2">
                    <h4>
                      <b>
                        Catégorie de transaction - {{ filterStatus }}
                      </b>
                    </h4>
                  </div>
                </div>
                <div>
                  <form class="d-flex">
                    <div class="pull-right">
                      <span class="p-input-icon-left">
                        <i class="pi pi-search"></i>
                        <input pInputText type="text"
                          (input)="dtransaction.filterGlobal($event.target.value,'contains')"
                          placeholder="Recherche..." />
                      </span>
                    </div>
                  </form>
                </div>
              </div>
            </ng-template>
            <br />
            <ng-template pTemplate="header">
              <tr>
                <th>#</th>
                <th pSortableColumn="date"> Date/Heure </th>
                <th pSortableColumn="num_transaction"> N° Transaction </th>
                <th pSortableColumn="type_operation" *ngIf="filtreSelected !=='Synchronisation'"> Type opération </th>
                <th pSortableColumn="operation" *ngIf="filtreSelected ==='Synchronisation'"> Opération </th>
                <th [ngStyle]="{ width: '200px' }" pSortableColumn="demandeur"> Demandeur </th>
                <th pSortableColumn="erreurs"> # Erreurs </th>
                <th pSortableColumn="statut"> Statut </th>
                <th>Actions</th>
              </tr>
            </ng-template>
            <ng-template pTemplate="body" let-operation let-i="rowIndex">
              <tr>
                <td style="text-align: center">{{ i + 1 }}</td>
                <td>{{ operation.date_debut }}</td>
                <td class="text-center"> {{ operation.transaction }} </td>
                <td class="text-center" *ngIf="filtreSelected !=='Synchronisation'"> {{ operation.type }} </td>
                <td class="text-center" *ngIf="filtreSelected ==='Synchronisation'"> {{ operation.operation }} </td>
                <td style="text-align: center">{{operation.nom_demandeur}} {{operation.prenoms_demandeur}}</td>
                <td style="text-align: center">{{operation.erreurs_count || 'N/A'}}</td>
                <td style="text-align: center">{{ operation.statut }}</td>
                <td>
                  <button pButton pRipple type="button" label="Détails" (click)="visualiser(operation)"></button>
                </td>
              </tr>
            </ng-template>
          </p-table>
        </div>
      </div>
    </div>
  </div>
</div>