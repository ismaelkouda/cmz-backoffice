<div *ngIf="!currentObject">
    <div class="forms-feature-header">
        <div class="d-flex gap-2">
            <div>
                <h3 class="current-transaction-label">
                    <span *ngIf="typeDemande === 'activation-en-masse'"
                        >Demande d'Abonnement en masse de carte SIM</span
                    >
                    <span *ngIf="typeDemande === 'activation-en-simple'"
                        >Demande d'Abonnement simple de carte SIM</span
                    >
                </h3>
            </div>
            <!-- <div class="d-flex gap-2" style="margin-top: -0.5rem" *ngIf="selectedActionValue === volume">
                <div class="box-card">
                    <span class="title">Dotation Data (Go) :</span>
                    <span class="valeur">
                        <span>{{currentPatrimoine?.solde_dotation ?? 0 | formatNumber: 2}}</span>
                    </span>
                </div>
                <div class="box-card">
                    <span class="title">Solde Data (Go) :</span>
                    <span class="valeur">
                        <span>{{currentPatrimoine?.solde_actuel_go ?? 0 | formatNumber: 2}}</span>
                    </span>
                </div>
            </div> -->
        </div>
        <div class="forms-feature-header__button">
            <div>
                <p-button
                    label="Fermer"
                    styleClass="p-button-danger"
                    (click)="close()"
                ></p-button>
            </div>
        </div>
    </div>

    <!-- <div *ngIf="typeDemande === 'simple'">
        <div class="activation-forms" *ngIf="this.router.url === '/demandes/activation'">
            <fieldset *ngIf="!historie">
                <legend>
                    <b>Source Stock SIM</b>
                </legend>
                <div style="display: flex; gap: 2rem" *ngIf="applicationType === patrimoineType">
                    <div class="trans-radio d-flex gap-3">
                        <p-radioButton name="valeur" [value]="sourceStock" [(ngModel)]="sourceValue"
                            (onClick)="selectedSource(sourceStock)" [inputId]="sourceStock"></p-radioButton>
                        <label [for]="sourceStock" style="margin-top: 0.9rem">Stock SIM/Tenant</label>
                    </div>
                </div>
                <div class="text-wrapper" *ngIf="applicationType === patrimoineType">
                    <input [value]="
                            sourceValue === 'stock'
                                ? sourceStockTenantSim
                                : sourceStockOrangeSim
                        " type="text" [disabled]="true" pInputText />
                </div>
                <div class="text-wrapper" *ngIf="applicationType !== patrimoineType">
                    <input [value]="sourceStockOrangeSim" type="text" [disabled]="true" pInputText />
                </div>
            </fieldset>
            <div [formGroup]="adminForm" novalidate>
                <fieldset *ngIf="this.historie">
                    <legend>
                        <b>Informations SIM</b>
                    </legend>
                    <div class="row">
                        <div class="col-md-4">
                            <div class="form-group">
                                <label>
                                    <b>IMSI</b>
                                </label>
                                <input type="text" formControlName="imsi" pInputText />
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label>
                                    <b>MSISDN</b>
                                </label>
                                <input type="text" formControlName="msisdn" pInputText />
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label>
                                    <b>Statut Contrat</b>
                                </label>
                                <input *ngIf="!historie" type="text" formControlName="statut" pInputText />
                                <app-statut-contrat *ngIf="historie" [statut]="statut_contrat"></app-statut-contrat>
                            </div>
                        </div>
                    </div>
                </fieldset>
                <fieldset *ngIf="selectedActionValue">
                    <legend>
                        <b>Demande</b>
                    </legend>
                    <div class="row">
                        <div class="col-md-3">
                            <div class="form-group">
                                <label>
                                    <b>Usage<span class="text-danger">*</span></b>
                                </label>
                                <p-dropdown [options]="listUsages" formControlName="usage_id" optionLabel="nom_usage"
                                    placeholder="usage" optionValue="id">
                                </p-dropdown>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="form-group">
                                <label>
                                    <b>Formule destination<span class="text-danger">*</span></b>
                                </label>
                                <p-dropdown [options]="listFormules" formControlName="formule_uuid" optionLabel="nom"
                                    [placeholder]="'Formule destination'" [showClear]="true" optionValue="uuid"
                                    [filter]="true" filterBy="nom">
                                </p-dropdown>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="form-group">
                                <label>
                                    <b>Courrier ou Document
                                        <span class="text-danger">*</span></b>
                                </label>
                                <input type="file" style="
                                        padding: 0.6rem;
                                        border: 1px solid #000;
                                        border-radius: 0.3rem;
                                        color: #000;
                                    " (change)="
                                        onChangeFile(
                                            $event.target.files,
                                            'justificatif'
                                        )
                                    " accept="image/png,image/jpeg" />
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="d-flex">
                                <div>
                                    <b style="color: black">Paiement
                                        <span class="text-danger">*</span></b>
                                </div>
                                <span>&nbsp;:&nbsp;</span>
                                <div class="wrapper-check">
                                    <div class="form-check form-check-inline">
                                        <input class="form-check-input" type="radio" name="demande" value="différé"
                                            id="différé" formControlName="type_paiement" />
                                        <label class="form-check-label" for="différé"
                                            style="width: auto !important">Différé</label>
                                    </div>
                                    <div class="form-check form-check-inline">
                                        <input class="form-check-input" type="radio" name="demande" value="immédiat"
                                            id="immédiat" formControlName="type_paiement" />
                                        <label class="form-check-label" for="immédiat"
                                            style="width: auto !important">immédiat</label>
                                    </div>
                                </div>
                            </div>
                            <div style="
                                    padding: 0.6rem;
                                    border: 1px solid #000;
                                    border-radius: 0.3rem;
                                    color: #000;
                                ">
                                <span class="payment-info" *ngIf="
                                        adminForm.get('type_paiement').value ===
                                        null
                                    ">
                                    <span>N/A</span>
                                </span>
                                <span *ngIf="
                                        adminForm.get('type_paiement').value ===
                                        'différé'
                                    ">Le paiement sera rattaché à la prochaine
                                    facture</span>
                                <input *ngIf="
                                        adminForm.get('type_paiement').value ===
                                        'immédiat'
                                    " type="file" (change)="
                                        onChangeFile(
                                            $event.target.files,
                                            'recu-paiement'
                                        )
                                    " accept="image/png,image/jpeg" />
                            </div>
                        </div>
                    </div>
                </fieldset>
                <fieldset>
                    <legend>
                        <b>Informations d'affectation</b>
                    </legend>
                    <div class="row">
                        <div class="col-md-4">
                            <div class="form-group">
                                <label>
                                    <b>{{ firstLevelLibelle }}</b>
                                </label>
                                <p-dropdown [options]="listDirections" formControlName="niveau_un_uuid"
                                    optionLabel="nom" [placeholder]="firstLevelLibelle" [filter]="true" filterBy="nom"
                                    optionValue="uuid" [showClear]="true">
                                    <ng-template let-data pTemplate="item">
                                        <div class="country-item">
                                            <div>
                                                {{ data.nom }}
                                            </div>
                                        </div>
                                    </ng-template>
                                </p-dropdown>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label>
                                    <b>{{ secondLevelLibelle }}</b>
                                </label>
                                <p-dropdown [options]="listExploitations" formControlName="niveau_deux_uuid"
                                    optionLabel="nom" [placeholder]="secondLevelLibelle" [filter]="true" filterBy="nom"
                                    optionValue="uuid" [showClear]="true">
                                    <ng-template let-data pTemplate="item">
                                        <div class="country-item">
                                            <div>
                                                {{ data.nom }}
                                            </div>
                                        </div>
                                    </ng-template>
                                </p-dropdown>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label>
                                    <b>{{ thirdLevelLibelle }}</b>
                                </label>
                                <p-dropdown [options]="listActivites" formControlName="niveau_trois_uuid"
                                    optionLabel="nom" [placeholder]="thirdLevelLibelle" [filter]="true" filterBy="nom"
                                    optionValue="uuid" [showClear]="true">
                                    <ng-template let-data pTemplate="item">
                                        <div class="country-item">
                                            <div>
                                                {{ data.nom }}
                                            </div>
                                        </div>
                                    </ng-template>
                                </p-dropdown>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-4">
                            <div class="form-group">
                                <label>
                                    <b>Nom Emplacement
                                        <span class="text-danger">*</span></b>
                                </label>
                                <input type="text" formControlName="point_emplacement" pInputText />
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label>
                                    <b>Adresse mail</b>
                                </label>
                                <input type="text" formControlName="adresse_email" pInputText />
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label>
                                    <b>Adresse géographique<span class="text-danger">*</span></b>
                                </label>
                                <input type="text" formControlName="adresse_geographique" pInputText />
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-group">
                                <label>
                                    <b>Latitude</b>
                                </label>
                                <input type="text" formControlName="latitude" pInputText />
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label>
                                    <b>Longitude</b>
                                </label>
                                <input type="text" formControlName="longitude" pInputText />
                            </div>
                        </div>
                    </div>
                </fieldset>
                <fieldset>
                    <legend>
                        <b>Description de la Demande</b>
                    </legend>
                    <div class="row">
                        <div class="col-md-12">
                            <div class="form-group">
                                <input type="text" formControlName="description" pInputText />
                            </div>
                        </div>
                    </div>
                </fieldset>
            </div>
        </div>
        <div *ngIf="
                selectedActionValue === swap ||
                selectedActionValue === resiliation ||
                selectedActionValue === suspension ||
                selectedActionValue === formule ||
                selectedActionValue === volume
            ">
            <fieldset>
                <legend>
                    <b>Informations de la SIM</b>
                </legend>
                <div>
                    <div class="row p-0">
                        <div class="col-md-4" *ngIf="!historie">
                            <div class="form-group">
                                <label>
                                    <div class="d-flex gap-5">
                                        <div class="trans-radio d-flex gap-3">
                                            <p-radioButton name="valeur" value="IMSI" [(ngModel)]="radioValue"
                                                (onClick)="changeItem($event)" inputId="imsi"></p-radioButton>
                                            <label for="imsi" style="
                                                    margin-top: 0.8rem;
                                                    font-size: 0.8rem;
                                                ">IMSI</label>
                                        </div>
                                        <div class="trans-radio d-flex gap-3">
                                            <p-radioButton name="valeur" value="MSISDN" [(ngModel)]="radioValue"
                                                (onClick)="changeItem($event)" inputId="msisdn"></p-radioButton>
                                            <label for="msisdn" style="
                                                    margin-top: 0.8rem;
                                                    font-size: 0.8rem;
                                                ">MSISDN</label>
                                        </div>
                                    </div>
                                </label>
                                <div class="d-flex gap-2">
                                    <input placeholder="Saisir le numéro" [(ngModel)]="selectedValue" type="text"
                                        pInputText />
                                    <button pButton pRipple label="Verifier" (click)="onVerify()"
                                        [disabled]="isFilter()" style="padding: 0 2rem 0 1rem" icon="pi pi-sync"
                                        class="p-button-success"></button>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-8"></div>
                    </div>
                </div>
                <div style="margin-top: 0.5rem">
                    <div class="wrapper-sim-infos">
                        <div>
                            <div class="form-group">
                                <label>
                                    <b>MSIDN</b>
                                </label>
                                <input type="text" [(ngModel)]="currentPatrimoine.msisdn" [disabled]="true"
                                    pInputText />
                            </div>
                        </div>
                        <div>
                            <div class="form-group">
                                <label>
                                    <b>IMSI</b>
                                </label>
                                <input type="text" [(ngModel)]="currentPatrimoine.imsi" [disabled]="true" pInputText />
                            </div>
                        </div>
                        <div>
                            <div class="form-group">
                                <label>
                                    <b>Formule</b>
                                </label>
                                <input type="text" [(ngModel)]="currentPatrimoine.formule" [disabled]="true"
                                    pInputText />
                            </div>
                        </div>
                        <div>
                            <div class="form-group">
                                <label>
                                    <b>Statut Contrat</b>
                                </label>
                                <input *ngIf="!currentPatrimoine?.statut" type="text"
                                    [(ngModel)]="currentPatrimoine.statut" pInputText [disabled]="true" />
                                <app-statut-contrat *ngIf="currentPatrimoine?.statut"
                                    [statut]="currentPatrimoine?.statut"></app-statut-contrat>
                            </div>
                        </div>
                        <div>
                            <div class="form-group">
                                <label>
                                    <b>Nom Emplacement</b>
                                </label>
                                <input type="text" [(ngModel)]="
                                        currentPatrimoine.point_emplacement
                                    " [disabled]="true" pInputText />
                            </div>
                        </div>
                    </div>
                </div>
            </fieldset>
            <fieldset>
                <legend>
                    <b>Détails de la demande</b>
                </legend>
                <div class="row p-1" *ngIf="
                        selectedActionValue === resiliation ||
                        selectedActionValue === suspension ||
                        selectedActionValue === formule
                    ">
                    <div class="col-md-4" *ngIf="selectedActionValue === formule">
                        <div class="form-group">
                            <label>
                                <b>Formule destination<span class="text-danger">*</span></b>
                            </label>
                            <p-dropdown [options]="listFormules" [(ngModel)]="selectedFormule" optionLabel="nom"
                                [placeholder]="'Formule destination'" [showClear]="true" optionValue="uuid">
                                <ng-template let-data pTemplate="item">
                                    <div class="country-item">
                                        <div>
                                            {{ data.nom }}
                                        </div>
                                    </div>
                                </ng-template>
                            </p-dropdown>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="form-group">
                            <label>
                                <b>Description
                                    <span class="text-danger">*</span></b>
                            </label>
                            <input type="text" [disabled]="isVerify()" [(ngModel)]="selectedDescription" pInputText />
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="form-group">
                            <label>
                                <b>Justificatif</b>
                            </label>
                            <input type="file" style="
                                    padding: 0.6rem;
                                    border: 1px solid #000;
                                    border-radius: 0.3rem;
                                    color: #000;
                                " (change)="
                                    onChangeFile(
                                        $event.target.files,
                                        'justificatif'
                                    )
                                " accept="image/png,image/jpeg" />
                        </div>
                    </div>
                </div>
                <div *ngIf="selectedActionValue === swap">
                    <div class="row">
                        <div style="display: flex; gap: 2rem">
                            <div class="trans-radio d-flex gap-3">
                                <p-radioButton name="valeur" [value]="sourceStock" [(ngModel)]="sourceValue"
                                    (onClick)="selectedSource(sourceStock)" [inputId]="sourceStock"></p-radioButton>
                                <label [for]="sourceStock" style="margin-top: 0.9rem">Stock SIM/Tenant</label>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="form-group">
                            <label style="opacity: 0">
                                <b> <span class="text-danger">*</span></b>
                            </label>
                            <input [value]="
                                    sourceValue === 'stock'
                                        ? sourceStockTenantSim
                                        : sourceStockOrangeSim
                                " type="text" [disabled]="true" pInputText />
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-4">
                            <div class="form-group">
                                <label>
                                    <b>Description
                                        <span class="text-danger">*</span></b>
                                </label>
                                <input type="text" [disabled]="isVerify()" [(ngModel)]="selectedDescription"
                                    pInputText />
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label>
                                    <b>Justificatif</b>
                                </label>
                                <input type="file" style="
                                        padding: 0.6rem;
                                        border: 1px solid #000;
                                        border-radius: 0.3rem;
                                        color: #000;
                                    " (change)="
                                        onChangeFile(
                                            $event.target.files,
                                            'justificatif'
                                        )
                                    " accept="image/png,image/jpeg" />
                            </div>
                        </div>
                    </div>
                </div>
                <div *ngIf="selectedActionValue === volume">
                    <div>
                        <div>
                            <div class="form-group">
                                <label style="opacity: 0; height: 0">
                                    <b> <span class="text-danger">*</span></b>
                                </label>
                                <input [value]="
                                        sourceValue === 'stock'
                                            ? sourceSoldeDotation
                                            : sourceSoldeDotationOrange
                                    " type="text" [disabled]="true" pInputText />
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-2">
                            <div class="form-group">
                                <label>
                                    <b>Volume (Go)
                                        <span class="text-danger">*</span></b>
                                </label>
                                <input type="number" [disabled]="isVerify()" [(ngModel)]="selectedVolume" pInputText />
                            </div>
                        </div>
                        <div class="col-md-5">
                            <div class="form-group">
                                <label>
                                    <b>Description</b>
                                </label>
                                <input type="text" [disabled]="isVerify()" [(ngModel)]="selectedDescription"
                                    pInputText />
                            </div>
                        </div>
                        <div class="col-md-5">
                            <div class="form-group">
                                <label>
                                    <b>Justificatif</b>
                                </label>
                                <input type="file" style="
                                        padding: 0.6rem;
                                        border: 1px solid #000;
                                        border-radius: 0.3rem;
                                        color: #000;
                                    " (change)="
                                        onChangeFile(
                                            $event.target.files,
                                            'justificatif'
                                        )
                                    " accept="image/png,image/jpeg" />
                            </div>
                        </div>
                    </div>
                </div>
            </fieldset>
        </div>
        <div class="submit-form" *ngIf="selectedActionValue">
            <div>
                <button pButton *ngIf="selectedActionValue !== activation" style="float: right; margin-top: 1rem"
                    label="Soumettre" class="p-button-success" [disabled]="IsFormFomSIMValidate()"
                    (click)="handleSaveNewTransaction()"></button>
                <button pButton *ngIf="selectedActionValue === activation" style="float: right; margin-top: 1rem"
                    label="Soumettre" class="p-button-success" [disabled]="adminForm.valid || !selectedPiece"
                    (click)="handleSaveNewTransaction()"></button>
            </div>
        </div>
    </div> -->

    <div>
        <div
            class="activation-forms"
            *ngIf="
                typeDemande === 'activation-en-masse' || 'activation-en-simple'
            "
        >
            <div [formGroup]="adminForm" novalidate>
                <fieldset>
                    <legend><b>Stock source de carte SIM</b></legend>
                    <div
                        class="row"
                        style="
                            padding-right: 0;
                            padding-left: 3px;
                            display: flex;
                            gap: 4px;
                            flex-wrap: nowrap;
                        "
                    >
                        <div
                            class="col-md-3 d-flex justify-content-around gap-2"
                            style="
                                border: 1px solid #ced4da;
                                height: 3.6rem;
                                border-radius: 6px;
                            "
                        >
                            <div
                                class="d-flex align-items-center justify-content-around gap-2 form-check form-check-inline p-0 m-0"
                            >
                                <input
                                    class="form-check-input"
                                    type="radio"
                                    name="stock_source"
                                    value="stock orange"
                                    id="stock_orange"
                                    formControlName="source"
                                    #stock_orange
                                    style="width: 25px; height: 25px"
                                />
                                <label
                                    class="form-check-label fs-5"
                                    for="stock_orange"
                                    style="width: inherit"
                                >
                                    <strong>Stock Orange</strong>
                                </label>
                            </div>
                            <div
                                class="d-flex align-items-center justify-content-around gap-2 form-check form-check-inline p-0 m-0"
                            >
                                <input
                                    class="form-check-input"
                                    type="radio"
                                    name="stock_source"
                                    value="stock local"
                                    id="mon_stock"
                                    formControlName="source"
                                    #mon_stock
                                    style="width: 25px; height: 25px"
                                />
                                <label
                                    class="form-check-label fs-5"
                                    for="mon_stock"
                                >
                                    <strong>Mon stock</strong>
                                </label>
                            </div>
                        </div>
                        <div
                            class="col-md-9"
                            style="padding-right: 10px"
                            *ngIf="stock_orange.checked"
                        >
                            <input
                                type="text"
                                pInputText
                                value="Orange fournira les cartes SIM"
                                disabled
                            />
                        </div>
                        <div
                            class="col-md-9"
                            style="
                                padding-right: 10px;
                                display: flex;
                                flex-wrap: nowrap;
                                gap: 4px;
                            "
                            *ngIf="mon_stock.checked"
                        >
                            <input
                                type="text"
                                pInputText
                                disabled
                                value="L'abonnement sera effectué sur les cartes SIM en ma possession"
                            />
                            <button
                                style="width: 15rem"
                                icon="pi pi-plus"
                                pButton
                                label="Prendre lots"
                                class="p-button-success"
                                (click)="showDialog()"
                            ></button>
                        </div>
                    </div>
                </fieldset>

                <fieldset>
                    <legend><strong>Informations demande</strong></legend>
                    <div class="row">
                        <div class="col-md">
                            <div class="form-group">
                                <label
                                    ><b>Nombre</b
                                    ><span class="text-danger">*</span></label
                                >
                                <input
                                    placeholder="nombre"
                                    formControlName="nb_demandes"
                                    type="number"
                                    pInputText
                                    style="font-size: 15px !important"
                                />
                            </div>
                        </div>
                        <div class="col-md-2">
                            <div class="form-group">
                                <label
                                    ><b
                                        >Usage<span class="text-danger"
                                            >*</span
                                        ></b
                                    ></label
                                >
                                <p-dropdown
                                    [options]="listUsages"
                                    formControlName="usage_id"
                                    optionLabel="nom_usage"
                                    placeholder="usage"
                                    optionValue="id"
                                    [showClear]="true"
                                >
                                </p-dropdown>
                            </div>
                        </div>
                        <div class="col-md-2">
                            <div class="form-group">
                                <label
                                    ><b
                                        >Formule d'abonnement<span
                                            class="text-danger"
                                            >*</span
                                        ></b
                                    ></label
                                >
                                <p-dropdown
                                    [options]="listFormules"
                                    formControlName="formule_uuid"
                                    optionLabel="nom"
                                    [placeholder]="'Formule destination'"
                                    [showClear]="true"
                                    optionValue="uuid"
                                >
                                </p-dropdown>
                            </div>
                        </div>
                        <div class="col-md-1">
                            <div class="form-group">
                                <label><b>PU (Fcfa)</b></label>
                                <input
                                    formControlName="prix_unitaire"
                                    type="number"
                                    pInputText
                                    style="font-size: 15px !important"
                                />
                            </div>
                        </div>
                        <div class="col-md">
                            <div class="form-group">
                                <label><b>Montant (Fcfa)</b></label>
                                <input
                                    formControlName="montant"
                                    type="number"
                                    pInputText
                                    style="font-size: 15px !important"
                                />
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="form-group">
                                <label
                                    ><b
                                        >Courrier ou Document<span
                                            class="text-danger"
                                            >*</span
                                        ></b
                                    ></label
                                >
                                <input
                                    type="file"
                                    style="
                                        padding: 0.6rem;
                                        border: 1px solid #000;
                                        border-radius: 0.3rem;
                                        color: #000;
                                    "
                                    (change)="
                                        onChangeFile(
                                            $event.target.files,
                                            'justificatif'
                                        )
                                    "
                                    accept="image/png,image/jpeg"
                                />
                            </div>
                        </div>
                    </div>
                </fieldset>

                <!-- /*************************************************activation-en-simple*****************************************/ -->

                <fieldset *ngIf="typeDemande === 'activation-en-simple'">
                    <legend>
                        <b>Informations d'affectation</b>
                    </legend>
                    <div class="row">
                        <div class="col-md-4">
                            <div class="form-group">
                                <label
                                    ><b>{{ firstLevelLibelle }}</b></label
                                >
                                <p-dropdown
                                    [options]="listDirections"
                                    formControlName="niveau_un_uuid"
                                    optionLabel="nom"
                                    [placeholder]="firstLevelLibelle"
                                    [filter]="true"
                                    filterBy="nom"
                                    optionValue="uuid"
                                    [showClear]="true"
                                >
                                    <ng-template let-data pTemplate="item">
                                        <div class="country-item">
                                            <div>{{ data.nom }}</div>
                                        </div>
                                    </ng-template>
                                </p-dropdown>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label
                                    ><b>{{ secondLevelLibelle }}</b></label
                                >
                                <p-dropdown
                                    [options]="listExploitations"
                                    formControlName="niveau_deux_uuid"
                                    optionLabel="nom"
                                    [placeholder]="secondLevelLibelle"
                                    [filter]="true"
                                    filterBy="nom"
                                    optionValue="uuid"
                                    [showClear]="true"
                                >
                                    <ng-template let-data pTemplate="item">
                                        <div class="country-item">
                                            <div>{{ data.nom }}</div>
                                        </div>
                                    </ng-template>
                                </p-dropdown>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label
                                    ><b>{{ thirdLevelLibelle }}</b></label
                                >
                                <p-dropdown
                                    [options]="listActivites"
                                    formControlName="niveau_trois_uuid"
                                    optionLabel="nom"
                                    [placeholder]="thirdLevelLibelle"
                                    [filter]="true"
                                    filterBy="nom"
                                    optionValue="uuid"
                                    [showClear]="true"
                                >
                                    <ng-template let-data pTemplate="item">
                                        <div class="country-item">
                                            <div>{{ data.nom }}</div>
                                        </div>
                                    </ng-template>
                                </p-dropdown>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-4">
                            <div class="form-group">
                                <label
                                    ><b
                                        >Nom Emplacement<span
                                            class="text-danger"
                                            >*</span
                                        ></b
                                    ></label
                                >
                                <input
                                    type="text"
                                    formControlName="point_emplacement"
                                    pInputText
                                />
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label><b>Adresse mail</b></label>
                                <input
                                    type="text"
                                    formControlName="adresse_email"
                                    pInputText
                                />
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label
                                    ><b
                                        >Adresse géographique<span
                                            class="text-danger"
                                            >*</span
                                        ></b
                                    ></label
                                >
                                <input
                                    type="text"
                                    formControlName="adresse_geographique"
                                    pInputText
                                />
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-group">
                                <label><b>Latitude</b></label>
                                <input
                                    type="text"
                                    formControlName="latitude"
                                    pInputText
                                />
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label><b>Longitude</b></label>
                                <input
                                    type="text"
                                    formControlName="longitude"
                                    pInputText
                                />
                            </div>
                        </div>
                    </div>
                </fieldset>
                <!-- <fieldset *ngIf="!historie">
                    <legend>
                        <b>Informations d'affectation</b>
                    </legend>
                    <div class="row">
                        <div class="col-md-4">
                            <div class="form-group">
                                <label
                                    ><b>{{ firstLevelLibelle }}</b></label
                                >
                                <p-dropdown
                                    [options]="listDirections"
                                    formControlName="niveau_un_uuid"
                                    optionLabel="nom"
                                    [placeholder]="firstLevelLibelle"
                                    optionValue="uuid"
                                    [showClear]="true"
                                >
                                </p-dropdown>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label
                                    ><b>{{ secondLevelLibelle }}</b></label
                                >
                                <p-dropdown
                                    [options]="listExploitations"
                                    formControlName="niveau_deux_uuid"
                                    optionLabel="nom"
                                    [placeholder]="secondLevelLibelle"
                                    optionValue="uuid"
                                    [showClear]="true"
                                >
                                </p-dropdown>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label
                                    ><b>{{ thirdLevelLibelle }}</b></label
                                >
                                <p-dropdown
                                    [options]="listActivites"
                                    formControlName="niveau_trois_uuid"
                                    optionLabel="nom"
                                    [placeholder]="thirdLevelLibelle"
                                    optionValue="uuid"
                                    [showClear]="true"
                                >
                                </p-dropdown>
                            </div>
                        </div>
                    </div>
                </fieldset> -->
                <fieldset>
                    <legend>
                        <b>Description de la Demande</b>
                    </legend>
                    <div class="row">
                        <div class="col-md-12 d-flex align-items-end">
                            <input
                                type="text"
                                formControlName="description"
                                pInputText
                                [ngStyle]="{ 'border-color': 'red' }"
                                placeholder="Commentez..."
                            />
                        </div>
                    </div>
                </fieldset>
            </div>
        </div>
        <div class="submit-form">
            <div>
                <button
                    pButton
                    style="float: right; margin-top: 1rem"
                    label="Soumettre"
                    class="p-button-success"
                    [disabled]="adminForm.invalid"
                    (click)="handleSaveMasse()"
                ></button>
            </div>
        </div>
    </div>
</div>
<!-- <p-dialog #dt header="Header" [resizable]="false" [modal]="true" [maximizable]="true" appendTo="body"
    [(visible)]="dialogVisible" [style]="{ width: '50vw' }" [contentStyle]="{ height: '150px' }"
    [globalFilterFields]="['numero_demande',]">
    <p-table [value]="listWhiteSimCard" [scrollable]="true" scrollHeight="flex" [tableStyle]="{ 'min-width': '50rem' }">
        <div class="d-flex justify-content-between">
            <div class="d-flex align-items-end">
                <app-search-table [dt]="dt"></app-search-table>
            </div>
        </div>
        <ng-template pTemplate="header">
            <tr>
                <th class="text-center" [style]="{ width: '1.5rem' }">#</th>
                <th>Référence</th>
            </tr>
        </ng-template>
        <ng-template pTemplate="body" let-rowIndex="rowIndex" let-customer>
            <tr>
                <td class="text-center">{{rowIndex + 1}}</td>
                <td class="text-center">{{ customer?.numero_demande }}</td>
            </tr>
        </ng-template>

    </p-table>
    <ng-template>
        <button pButton label="Enregistrer" class="p-button-success" (click)="dialogVisible = false">
        </button>
    </ng-template>
</p-dialog> -->

<!-- <div class="card">
    <p-dialog [header]="'Liste des lots disponibles [' + totalDisponibles + ']'" [resizable]="false" [modal]="true"
        [maximizable]="true" appendTo="body" id="dialogHeaderTableWhiteSimCard" [(visible)]="dialogVisible"
        [style]="{ width: '60vw' }">
        <p-table editMode="row" dataKey="id" #dt [value]="listWhiteSimCard" [scrollable]="true" scrollHeight="flex"
            [paginator]="true" [rows]="5"
            currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries">
            <ng-template pTemplate="caption">
                <div class="d-flex justify-content-end mt-3">
                    <app-search-table [dt]="dt"></app-search-table>
                </div>
            </ng-template>

            <ng-template pTemplate="header">
                <tr>
                    <th style="display: flex; justify-content: center; max-width: 4rem;">#</th>
                    <th style="display: flex; justify-content: center;">Référence</th>
                    <th style="display: flex; justify-content: center;">SIM disponibles</th>
                    <th style="display: flex; justify-content: center;">Sélection</th>
                    <th style="display: flex; justify-content: center;">
                        Actions
                    </th>
                </tr>
            </ng-template>

            <ng-template pTemplate="body" let-rowIndex="rowIndex" let-customer let-editing="editing">
                <tr [pEditableRow]="customer" [editableRow]="editableRowIndex === rowIndex">
                    <td style="display: flex; justify-content: center; max-width: 4rem;">
                        {{ rowIndex + 1 }}
                    </td>

                    <td style="display: flex; justify-content: center;">{{ customer?.numero_demande }}</td>

                    <td style="display: flex; justify-content: center;">{{ customer?.nb_restants }}</td>

                    <td style="display: flex; justify-content: center;">
                        <p-cellEditor>
                            <ng-template pTemplate="input">
                                <div class="d-flex gap-2">
                                    <input pInputText type="number" [(ngModel)]="customer.selected_nb_restants" />
                                </div>
                            </ng-template>
                            <ng-template pTemplate="output">
                                {{ customer?.selected_nb_restants || 0 }}
                            </ng-template>
                        </p-cellEditor>
                    </td>

                    <td class="td-actions">

                        <button *ngIf="!editing" pButton pRipple type="button" pInitEditableRow pTooltip="Modifier"
                            tooltipPosition="top" icon="pi pi-pencil" (click)="editRow(customer, rowIndex)"
                            class="p-button-secondary"></button>

                        <button *ngIf="editing" pButton pRipple type="button" pSaveEditableRow pTooltip="Sauvegarder"
                            tooltipPosition="top" icon="pi pi-check" (click)="saveRowEdit(customer)"
                            class="p-button-success"></button>

                        <button *ngIf="editing" pButton pRipple type="button" pCancelEditableRow pTooltip="Fermer"
                            tooltipPosition="top" icon="pi pi-times" (click)="cancelRowEdit(customer, rowIndex)"
                            class="p-button-danger" style="margin-left: 1rem"></button>
                    </td>
                </tr>
            </ng-template>
        </p-table>
        <div class="d-flex justify-content-between align-items-center mt-3">
            <p class="fs-4 mb-0"><b>Nombre sélectionné [ <span>Lot&nbsp;:&nbsp;{{globalMetriquesEditRow.length ||
                        0}}</span>&nbsp;<span>SIM&nbsp;:&nbsp;{{totalQuantitePrises || 0}}</span> ]</b></p>
            <button pButton label="Valider" class="p-button-success" (click)="HandleSaveLotSingle()"></button>
        </div>
    </p-dialog>
</div> -->

<div class="card">
    <p-dialog
        [resizable]="false"
        [modal]="true"
        [header]="'Liste des lots disponibles [' + totalDisponibles + ']'"
        [maximizable]="true"
        appendTo="body"
        id="dialogHeaderTableWhiteSimCard"
        [(visible)]="dialogVisible"
        [style]="{ width: '60vw' }"
    >
        <!-- /*************************************************Modal activation-en-masse***********************************************/ -->
        <ng-container *ngIf="typeDemande === 'activation-en-masse'">
            <p-table
                editMode="row"
                dataKey="id"
                #dt
                [value]="listWhiteSimCard"
                [scrollable]="true"
                scrollHeight="flex"
                [paginator]="true"
                [rows]="5"
                currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries"
            >
                <ng-template pTemplate="caption">
                    <div class="d-flex justify-content-end mt-3">
                        <app-search-table [dt]="dt"></app-search-table>
                    </div>
                </ng-template>

                <ng-template pTemplate="header">
                    <tr>
                        <th
                            style="
                                display: flex;
                                justify-content: center;
                                max-width: 4rem;
                            "
                        >
                            #
                        </th>
                        <th style="display: flex; justify-content: center">
                            Référence
                        </th>
                        <th style="display: flex; justify-content: center">
                            SIM disponibles
                        </th>
                        <th style="display: flex; justify-content: center">
                            Sélection
                        </th>
                        <th style="display: flex; justify-content: center">
                            Actions
                        </th>
                    </tr>
                </ng-template>

                <ng-template
                    pTemplate="body"
                    let-rowIndex="rowIndex"
                    let-customer
                    let-editing="editing"
                >
                    <tr
                        [pEditableRow]="customer"
                        [editableRow]="editableRowIndex === rowIndex"
                    >
                        <td
                            style="
                                display: flex;
                                justify-content: center;
                                max-width: 4rem;
                            "
                        >
                            {{ rowIndex + 1 }}
                        </td>

                        <td style="display: flex; justify-content: center">
                            {{ customer?.numero_demande }}
                        </td>

                        <td style="display: flex; justify-content: center">
                            {{ customer?.nb_restants }}
                        </td>

                        <td style="display: flex; justify-content: center">
                            <p-cellEditor>
                                <ng-template pTemplate="input">
                                    <div class="d-flex gap-2">
                                        <input
                                            pInputText
                                            type="number"
                                            [(ngModel)]="
                                                customer.selected_nb_restants
                                            "
                                        />
                                    </div>
                                </ng-template>
                                <ng-template pTemplate="output">
                                    {{ customer?.selected_nb_restants || 0 }}
                                </ng-template>
                            </p-cellEditor>
                        </td>

                        <td class="td-actions">
                            <button
                                *ngIf="!editing"
                                pButton
                                pRipple
                                type="button"
                                pInitEditableRow
                                pTooltip="Modifier"
                                tooltipPosition="top"
                                icon="pi pi-pencil"
                                (click)="editRow(customer, rowIndex)"
                                class="p-button-secondary"
                            ></button>

                            <button
                                *ngIf="editing"
                                pButton
                                pRipple
                                type="button"
                                pSaveEditableRow
                                pTooltip="Sauvegarder"
                                tooltipPosition="top"
                                icon="pi pi-check"
                                (click)="saveRowEdit(customer)"
                                class="p-button-success"
                            ></button>

                            <button
                                *ngIf="editing"
                                pButton
                                pRipple
                                type="button"
                                pCancelEditableRow
                                pTooltip="Fermer"
                                tooltipPosition="top"
                                icon="pi pi-times"
                                (click)="cancelRowEdit(customer, rowIndex)"
                                class="p-button-danger"
                                style="margin-left: 1rem"
                            ></button>
                        </td>
                    </tr>
                </ng-template>
            </p-table>
            <div class="d-flex justify-content-between align-items-center mt-3">
                <p class="fs-4 mb-0">
                    <b
                        >Nombre sélectionné [
                        <span
                            >Lot&nbsp;:&nbsp;{{
                                globalMetriquesEditRow.length || 0
                            }}</span
                        >&nbsp;<span
                            >SIM&nbsp;:&nbsp;{{
                                totalQuantitePrises || 0
                            }}</span
                        >
                        ]</b
                    >
                </p>
                <button
                    pButton
                    label="Valider"
                    class="p-button-success"
                    (click)="HandleSaveLotMasse()"
                ></button>
            </div>
        </ng-container>

        <!-- /*************************************************Modal activation-en-simple***********************************************/ -->

        <ng-container *ngIf="typeDemande === 'activation-en-simple'">
            <p-table
                #dt
                [value]="listWhiteSimCard"
                [scrollable]="true"
                scrollHeight="flex"
                [paginator]="true"
                [rows]="5"
                selectionMode="single"
                dataKey="id"
                [(selection)]="selectedLot"
                currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries"
            >
                <ng-template pTemplate="caption">
                    <div class="d-flex justify-content-end mt-3">
                        <app-search-table [dt]="dt"></app-search-table>
                    </div>
                </ng-template>

                <ng-template pTemplate="header">
                    <tr>
                        <th
                            style="
                                display: flex;
                                justify-content: center;
                                max-width: 4rem;
                            "
                        >
                            #
                        </th>
                        <th style="display: flex; justify-content: center">
                            Référence
                        </th>
                        <th style="display: flex; justify-content: center">
                            SIM disponibles
                        </th>
                        <th
                            style="
                                display: flex;
                                justify-content: center;
                                max-width: 4rem;
                            "
                        >
                            <div style="display: flex; justify-content: center">
                                <p-tableHeaderCheckbox></p-tableHeaderCheckbox>
                            </div>
                        </th>
                    </tr>
                </ng-template>

                <ng-template pTemplate="body" let-rowIndex="rowIndex" let-lot>
                    <tr>
                        <td
                            style="
                                display: flex;
                                justify-content: center;
                                max-width: 4rem;
                            "
                        >
                            {{ rowIndex + 1 }}
                        </td>

                        <td style="display: flex; justify-content: center">
                            {{ lot?.numero_demande }}
                        </td>

                        <td style="display: flex; justify-content: center">
                            {{ lot?.nb_restants }}
                        </td>

                        <td
                            style="
                                display: flex;
                                justify-content: center;
                                max-width: 4rem;
                            "
                        >
                            <div style="display: flex; justify-content: center">
                                <p-tableCheckbox
                                    [value]="lot"
                                ></p-tableCheckbox>
                            </div>
                        </td>
                    </tr>
                </ng-template>
            </p-table>
            <div class="d-flex justify-content-end align-items-center mt-3">
                <button
                    pButton
                    label="Valider"
                    class="p-button-success"
                    (click)="HandleSaveLotSimple()"
                    [disabled]="!selectedLot || !selectedLot.length"
                ></button>
            </div>
        </ng-container>
    </p-dialog>
</div>

<!-- <div class="card">
    <p-dialog [header]="'Liste des lots disponibles [' + totalDisponibles + ']'" [resizable]="false" [modal]="true"
        [maximizable]="true" appendTo="body" id="dialogHeaderTableWhiteSimCard" [(visible)]="dialogVisible"
        [style]="{ width: '60vw' }">
        <p-table [value]="listWhiteSimCard" dataKey="id">
            <ng-template pTemplate="caption">
                <div style="display: flex; justify-content: space-between; margin-top: 5px;">
                    <div>
                        <p-button label="Expand All" icon="pi pi-plus" text (onClick)="expandAll()" ></p-button>&nbsp;
                        <p-button label="Collapse All" icon="pi pi-minus" text (onClick)="collapseAll()" ></p-button>
                    </div>
                    <app-search-table [dt]="dt"></app-search-table>
                </div>
            </ng-template>
            <ng-template pTemplate="header">
                <tr>
                    <th style="width: 5rem"></th>
                    <th style="width: 4rem">#</th>
                    <th>Référence</th>
                    <th>SIM disponibles</th>
                    <th>Sélection</th>
                </tr>
            </ng-template>
            <ng-template pTemplate="body" let-rowIndex="rowIndex" let-customer let-expanded="expanded">
                <tr>
                    <td style="width: 5rem">
                        <p-button type="button" pRipple [pRowToggler]="customer" [text]="true" [rounded]="true"
                            [plain]="true" [icon]="expanded ? 'pi pi-chevron-down' : 'pi pi-chevron-right'" >
                        </p-button>
                    </td>
                    <td style="max-width: 4rem;">
                        {{ rowIndex + 1 }}
                    </td>

                    <td>{{ customer?.numero_demande }}</td>

                    <td>{{ customer?.nb_restants }}</td>

                    <td>
                        <p-cellEditor>
                            <ng-template pTemplate="input">
                                <div class="d-flex gap-2">
                                    <input pInputText type="number" [(ngModel)]="customer.selected_nb_restants" />
                                </div>
                            </ng-template>
                            <ng-template pTemplate="output">
                                {{ customer?.selected_nb_restants || 0 }}
                            </ng-template>
                        </p-cellEditor>
                    </td>
                </tr>
            </ng-template>
            <ng-template pTemplate="expandedrow" let-product>
                <tr>
                    <td colspan="7">
                        <div class="p-4">
                            <h5>Orders for {{ product.name }}</h5>
                            <p-table [value]="product.orders" dataKey="id">
                                <ng-template #header>
                                    <tr>
                                        <th pSortableColumn="id">Id</th>
                                        <th pSortableColumn="customer">Customer</th>
                                        <th pSortableColumn="date">Date</th>
                                        <th pSortableColumn="amount">Amount</th>
                                        <th pSortableColumn="status">Status</th>
                                        <th style="width: 4rem"></th>
                                    </tr>
                                </ng-template>
                                <ng-template #body let-order>
                                    <tr>
                                        <td>{{ order.id }}</td>
                                        <td>{{ order.customer }}</td>
                                        <td>{{ order.date }}</td>
                                        <td>{{ order.amount | currency : 'USD' }}</td>
                                        <td>
                                            
                                        </td>
                                        <td><p-button type="button" icon="pi pi-search" ></p-button></td>
                                    </tr>
                                </ng-template>
                                <ng-template #emptymessage>
                                    <tr>
                                        <td colspan="6">There are no order for this product yet.</td>
                                    </tr>
                                </ng-template>
                            </p-table>
                        </div>
                    </td>
                </tr>
            </ng-template>
        </p-table>
    </p-dialog>
</div> -->

<!-- <div *ngIf="currentObject">
    <div class="forms-feature-header">
        <div class="d-flex gap-2">
            <div>
                <h3 class="current-transaction-label">
                    <b>
                        <span>Demande</span><span *ngIf="selectedActionValue" class="mx-2">|</span><span
                            *ngIf="selectedActionValue">{{
                            formatTitle(selectedActionValue)
                            }}</span>
                        <span class="current_values" *ngIf="
                                selectedActionValue !== activation &&
                                selectedActionValue &&
                                typeDemande === 'simple'
                            ">[{{
                            getFormattedMsisdn(
                            currentPatrimoine?.msisdn ?? '0000000000'
                            )
                            }}]</span>
                    </b>
                </h3>
            </div>
            <div class="d-flex gap-2" style="margin-top: -0.5rem" *ngIf="selectedActionValue === volume">
                <div class="box-card">
                    <span class="title">Dotation Data (Go) :</span>
                    <span class="valeur">
                        <span>{{
                            currentPatrimoine?.solde_dotation ?? 0
                            | formatNumber: 2
                            }}</span>
                    </span>
                </div>
                <div class="box-card">
                    <span class="title">Solde Data (Go) :</span>
                    <span class="valeur">
                        <span>{{
                            currentPatrimoine?.solde_actuel_go ?? 0
                            | formatNumber: 2
                            }}</span>
                    </span>
                </div>
            </div>
        </div>
        <div class="forms-feature-header__button">
            <div>
                <p-button label="Fermer" styleClass="p-button-danger" (click)="close()"></p-button>
            </div>
        </div>
    </div>
    <div>
        <div class="activation-forms" *ngIf="selectedActionValue === activation">
            <fieldset *ngIf="!historie">
                <legend>
                    <b>Source Stock SIM</b>
                </legend>
                <div style="display: flex; gap: 2rem" *ngIf="applicationType === patrimoineType">
                    <div class="trans-radio d-flex gap-3">
                        <p-radioButton name="valeur" [value]="sourceStock" [(ngModel)]="sourceValue"
                            (onClick)="selectedSource(sourceStock)" [inputId]="sourceStock"></p-radioButton>
                        <label [for]="sourceStock" style="margin-top: 0.9rem">Stock SIM/Tenant</label>
                    </div>
                </div>
                <div class="text-wrapper" *ngIf="applicationType === patrimoineType">
                    <input [value]="
                            sourceValue === 'stock'
                                ? sourceStockTenantSim
                                : sourceStockOrangeSim
                        " type="text" [disabled]="true" pInputText />
                </div>
                <div class="text-wrapper" *ngIf="applicationType !== patrimoineType">
                    <input [value]="sourceStockOrangeSim" type="text" [disabled]="true" pInputText />
                </div>
            </fieldset>
            <div [formGroup]="adminForm" novalidate>
                <fieldset *ngIf="this.historie">
                    <legend>
                        <b>Informations SIM</b>
                    </legend>
                    <div class="row">
                        <div class="col-md-4">
                            <div class="form-group">
                                <label>
                                    <b>IMSI</b>
                                </label>
                                <input type="text" formControlName="imsi" pInputText />
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label>
                                    <b>MSISDN</b>
                                </label>
                                <input type="text" formControlName="msisdn" pInputText />
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label>
                                    <b>Statut Contrat</b>
                                </label>
                                <input *ngIf="!historie" type="text" formControlName="statut" pInputText />
                                <app-statut-contrat *ngIf="historie" [statut]="statut_contrat"></app-statut-contrat>
                            </div>
                        </div>
                    </div>
                </fieldset>
                <fieldset>
                    <legend>
                        <b>Informations d'identification</b>
                    </legend>
                    <div class="row">
                        <div class="col-md-4">
                            <div class="form-group">
                                <label>
                                    <b>{{ firstLevelLibelle
                                        }}<span class="text-danger">*</span></b>
                                </label>
                                <p-dropdown [options]="listDirections" formControlName="niveau_un_uuid"
                                    optionLabel="nom" [placeholder]="firstLevelLibelle" [filter]="true" filterBy="nom"
                                    optionValue="uuid">
                                    <ng-template let-data pTemplate="item">
                                        <div class="country-item">
                                            <div>
                                                {{ data.nom }}
                                            </div>
                                        </div>
                                    </ng-template>
                                </p-dropdown>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label>
                                    <b>{{ secondLevelLibelle
                                        }}<span class="text-danger">*</span></b>
                                </label>
                                <p-dropdown [options]="listExploitations" formControlName="niveau_deux_uuid"
                                    optionLabel="nom" [placeholder]="secondLevelLibelle" [filter]="true" filterBy="nom"
                                    optionValue="uuid">
                                    <ng-template let-data pTemplate="item">
                                        <div class="country-item">
                                            <div>
                                                {{ data.nom }}
                                            </div>
                                        </div>
                                    </ng-template>
                                </p-dropdown>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label>
                                    <b>{{ thirdLevelLibelle
                                        }}<span class="text-danger">*</span></b>
                                </label>
                                <p-dropdown [options]="listActivites" formControlName="niveau_trois_uuid"
                                    optionLabel="nom" [placeholder]="thirdLevelLibelle" [filter]="true" filterBy="nom"
                                    optionValue="uuid">
                                    <ng-template let-data pTemplate="item">
                                        <div class="country-item">
                                            <div>
                                                {{ data.nom }}
                                            </div>
                                        </div>
                                    </ng-template>
                                </p-dropdown>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-4">
                            <div class="form-group">
                                <label>
                                    <b>Nom Emplacement
                                        <span class="text-danger">*</span></b>
                                </label>
                                <input type="text" formControlName="point_emplacement" pInputText />
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label>
                                    <b>Usage<span class="text-danger">*</span></b>
                                </label>
                                <p-dropdown [options]="listUsages" formControlName="usage_id" optionLabel="nom_usage"
                                    placeholder="usage" optionValue="id">
                                </p-dropdown>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label>
                                    <b>Adresse mail</b>
                                </label>
                                <input type="text" formControlName="adresse_email" pInputText />
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-4">
                            <div class="form-group">
                                <label>
                                    <b>Adresse géographique<span class="text-danger">*</span></b>
                                </label>
                                <input type="text" formControlName="adresse_geographique" pInputText />
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label>
                                    <b>Latitude</b>
                                </label>
                                <input type="text" formControlName="latitude" pInputText />
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label>
                                    <b>Longitude</b>
                                </label>
                                <input type="text" formControlName="longitude" pInputText />
                            </div>
                        </div>
                    </div>
                </fieldset>
                <fieldset>
                    <legend>
                        <b>Détails de la Demande</b>
                    </legend>
                    <div class="row">
                        <div class="col-md-4">
                            <div class="form-group">
                                <label>
                                    <b>Formule destination<span class="text-danger">*</span></b>
                                </label>
                                <p-dropdown [options]="listFormules" formControlName="formule_uuid" optionLabel="nom"
                                    [placeholder]="'Formule destination'" [showClear]="true" optionValue="uuid"
                                    [filter]="true" filterBy="nom">
                                </p-dropdown>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label>
                                    <b>Description
                                        <span class="text-danger">*</span></b>
                                </label>
                                <input type="text" formControlName="description" pInputText />
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label>
                                    <b>Justificatif
                                        <span class="text-danger">*</span></b>
                                </label>
                                <input type="file" style="
                                        padding: 0.6rem;
                                        border: 1px solid #000;
                                        border-radius: 0.3rem;
                                        color: #000;
                                    " (change)="onChangeFile($event.target.files)" accept="image/png,image/jpeg" />
                            </div>
                        </div>
                    </div>
                </fieldset>
            </div>
        </div>
        <div *ngIf="
                selectedActionValue === swap ||
                selectedActionValue === resiliation ||
                selectedActionValue === suspension ||
                selectedActionValue === formule ||
                selectedActionValue === volume
            ">
            <fieldset>
                <legend>
                    <b>Informations de la SIM</b>
                </legend>
                <div>
                    <div class="row p-0">
                        <div class="col-md-4" *ngIf="!historie">
                            <div class="form-group">
                                <label>
                                    <div class="d-flex gap-5">
                                        <div class="trans-radio d-flex gap-3">
                                            <p-radioButton name="valeur" value="IMSI" [(ngModel)]="radioValue"
                                                (onClick)="changeItem($event)" inputId="imsi"></p-radioButton>
                                            <label for="imsi" style="
                                                    margin-top: 0.8rem;
                                                    font-size: 0.8rem;
                                                ">IMSI</label>
                                        </div>
                                        <div class="trans-radio d-flex gap-3">
                                            <p-radioButton name="valeur" value="MSISDN" [(ngModel)]="radioValue"
                                                (onClick)="changeItem($event)" inputId="msisdn"></p-radioButton>
                                            <label for="msisdn" style="
                                                    margin-top: 0.8rem;
                                                    font-size: 0.8rem;
                                                ">MSISDN</label>
                                        </div>
                                    </div>
                                </label>
                                <div class="d-flex gap-2">
                                    <input placeholder="Saisir le numéro" [(ngModel)]="selectedValue" type="text"
                                        pInputText />
                                    <button pButton pRipple label="Verifier" (click)="onVerify()"
                                        [disabled]="isFilter()" style="padding: 0 2rem 0 1rem" icon="pi pi-sync"
                                        class="p-button-success"></button>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-8"></div>
                    </div>
                </div>
                <div style="margin-top: 0.5rem">
                    <div class="wrapper-sim-infos">
                        <div>
                            <div class="form-group">
                                <label>
                                    <b>MSIDN</b>
                                </label>
                                <input type="text" [(ngModel)]="currentPatrimoine.msisdn" [disabled]="true"
                                    pInputText />
                            </div>
                        </div>
                        <div>
                            <div class="form-group">
                                <label>
                                    <b>IMSI</b>
                                </label>
                                <input type="text" [(ngModel)]="currentPatrimoine.imsi" [disabled]="true" pInputText />
                            </div>
                        </div>
                        <div>
                            <div class="form-group">
                                <label>
                                    <b>Formule</b>
                                </label>
                                <input type="text" [(ngModel)]="currentPatrimoine.formule" [disabled]="true"
                                    pInputText />
                            </div>
                        </div>
                        <div>
                            <div class="form-group">
                                <label>
                                    <b>Statut Contrat</b>
                                </label>
                                <input *ngIf="!currentPatrimoine?.statut" type="text"
                                    [(ngModel)]="currentPatrimoine.statut" pInputText [disabled]="true" />
                                <app-statut-contrat *ngIf="currentPatrimoine?.statut"
                                    [statut]="currentPatrimoine?.statut"></app-statut-contrat>
                            </div>
                        </div>
                        <div>
                            <div class="form-group">
                                <label>
                                    <b>Nom Emplacement</b>
                                </label>
                                <input type="text" [(ngModel)]="
                                        currentPatrimoine.point_emplacement
                                    " [disabled]="true" pInputText />
                            </div>
                        </div>
                    </div>
                </div>
            </fieldset>
            <fieldset>
                <legend>
                    <b>Détails de la demande</b>
                </legend>
                <div class="row p-1" *ngIf="
                        selectedActionValue === resiliation ||
                        selectedActionValue === suspension ||
                        selectedActionValue === formule
                    ">
                    <div class="col-md-4" *ngIf="selectedActionValue === formule">
                        <div class="form-group">
                            <label>
                                <b>Formule destination<span class="text-danger">*</span></b>
                            </label>
                            <p-dropdown [options]="listFormules" [(ngModel)]="selectedFormule" optionLabel="nom"
                                [placeholder]="'Formule destination'" [showClear]="true" optionValue="uuid">
                                <ng-template let-data pTemplate="item">
                                    <div class="country-item">
                                        <div>
                                            {{ data.nom }}
                                        </div>
                                    </div>
                                </ng-template>
                            </p-dropdown>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="form-group">
                            <label>
                                <b>Description
                                    <span class="text-danger">*</span></b>
                            </label>
                            <input type="text" [disabled]="isVerify()" [(ngModel)]="selectedDescription" pInputText />
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="form-group">
                            <label>
                                <b>Justificatif</b>
                            </label>
                            <input type="file" style="
                                    padding: 0.6rem;
                                    border: 1px solid #000;
                                    border-radius: 0.3rem;
                                    color: #000;
                                " (change)="onChangeFile($event.target.files)" accept="image/png,image/jpeg" />
                        </div>
                    </div>
                </div>
                <div *ngIf="selectedActionValue === swap">
                    <div class="row">
                        <div style="display: flex; gap: 2rem">
                            <div class="trans-radio d-flex gap-3">
                                <p-radioButton name="valeur" [value]="sourceStock" [(ngModel)]="sourceValue"
                                    (onClick)="selectedSource(sourceStock)" [inputId]="sourceStock"></p-radioButton>
                                <label [for]="sourceStock" style="margin-top: 0.9rem">Stock SIM/Tenant</label>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="form-group">
                            <label style="opacity: 0">
                                <b> <span class="text-danger">*</span></b>
                            </label>
                            <input [value]="
                                    sourceValue === 'stock'
                                        ? sourceStockTenantSim
                                        : sourceStockOrangeSim
                                " type="text" [disabled]="true" pInputText />
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-4">
                            <div class="form-group">
                                <label>
                                    <b>Description
                                        <span class="text-danger">*</span></b>
                                </label>
                                <input type="text" [disabled]="isVerify()" [(ngModel)]="selectedDescription"
                                    pInputText />
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label>
                                    <b>Justificatif</b>
                                </label>
                                <input type="file" style="
                                        padding: 0.6rem;
                                        border: 1px solid #000;
                                        border-radius: 0.3rem;
                                        color: #000;
                                    " (change)="onChangeFile($event.target.files)" accept="image/png,image/jpeg" />
                            </div>
                        </div>
                    </div>
                </div>
                <div *ngIf="selectedActionValue === volume">
                    <div>
                        <div>
                            <div class="form-group">
                                <label style="opacity: 0; height: 0">
                                    <b> <span class="text-danger">*</span></b>
                                </label>
                                <input [value]="
                                        sourceValue === 'stock'
                                            ? sourceSoldeDotation
                                            : sourceSoldeDotationOrange
                                    " type="text" [disabled]="true" pInputText />
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-2">
                            <div class="form-group">
                                <label>
                                    <b>Volume (Go)
                                        <span class="text-danger">*</span></b>
                                </label>
                                <input type="number" [disabled]="isVerify()" [(ngModel)]="selectedVolume" pInputText />
                            </div>
                        </div>
                        <div class="col-md-5">
                            <div class="form-group">
                                <label>
                                    <b>Description</b>
                                </label>
                                <input type="text" [disabled]="isVerify()" [(ngModel)]="selectedDescription"
                                    pInputText />
                            </div>
                        </div>
                        <div class="col-md-5">
                            <div class="form-group">
                                <label>
                                    <b>Justificatif</b>
                                </label>
                                <input type="file" style="
                                        padding: 0.6rem;
                                        border: 1px solid #000;
                                        border-radius: 0.3rem;
                                        color: #000;
                                    " (change)="onChangeFile($event.target.files)" accept="image/png,image/jpeg" />
                            </div>
                        </div>
                    </div>
                </div>
            </fieldset>
        </div>
        <div class="submit-form" *ngIf="selectedActionValue">
            <div>
                <button pButton *ngIf="selectedActionValue !== activation" style="float: right; margin-top: 1rem"
                    label="Soumettre" class="p-button-success" [disabled]="IsFormFomSIMValidate()"
                    (click)="handleSaveNewTransaction()"></button>
                <button pButton *ngIf="
                        selectedActionValue === activation &&
                        typeDemande !== 'modifier'
                    " style="float: right; margin-top: 1rem" label="Soumettre" class="p-button-success"
                    [disabled]="!adminForm.valid || !selectedPiece" (click)="handleSaveNewTransaction()"></button>
                <button pButton *ngIf="
                        selectedActionValue === activation &&
                        typeDemande === 'modifier'
                    " style="float: right; margin-top: 1rem" label="Modifier" class="p-button-success"
                    [disabled]="!adminForm.valid || !selectedPiece" (click)="handleSaveNewTransaction()"></button>
            </div>
        </div>
    </div>
    <div *ngIf="typeDemande === 'masse'">
        <div class="activation-forms" *ngIf="this.router.url === '/demandes/activation'">
            <div [formGroup]="adminForm" novalidate>
                <fieldset *ngIf="!historie">
                    <legend>
                        <b>Informations d'identification</b>
                    </legend>
                    <div class="row">
                        <div class="col-md-2">
                            <div class="form-group">
                                <label><b>{{ firstLevelLibelle
                                        }}<span class="text-danger">*</span></b></label>
                                <p-dropdown [options]="listDirections" formControlName="niveau_un_uuid"
                                    optionLabel="nom" [placeholder]="firstLevelLibelle" optionValue="uuid"
                                    [showClear]="true">
                                </p-dropdown>
                            </div>
                        </div>
                        <div class="col-md-2">
                            <div class="form-group">
                                <label><b>{{ secondLevelLibelle
                                        }}<span class="text-danger">*</span></b></label>
                                <p-dropdown [options]="listExploitations" formControlName="niveau_deux_uuid"
                                    optionLabel="nom" [placeholder]="secondLevelLibelle" optionValue="uuid"
                                    [showClear]="true">
                                </p-dropdown>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="form-group">
                                <label><b>{{ thirdLevelLibelle
                                        }}<span class="text-danger">*</span></b></label>
                                <p-dropdown [options]="listActivites" formControlName="niveau_trois_uuid"
                                    optionLabel="nom" [placeholder]="thirdLevelLibelle" optionValue="uuid"
                                    [showClear]="true">
                                </p-dropdown>
                            </div>
                        </div>
                        <div class="col-md-2">
                            <div class="form-group">
                                <label><b>Usage<span class="text-danger">*</span></b></label>
                                <p-dropdown [options]="listUsages" formControlName="usage_id" optionLabel="nom_usage"
                                    placeholder="usage" optionValue="id" [showClear]="true">
                                </p-dropdown>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="form-group">
                                <label><b>Formule destination<span class="text-danger">*</span></b></label>
                                <p-dropdown [options]="listFormules" formControlName="formule_uuid" optionLabel="nom"
                                    [placeholder]="'Formule destination'" [showClear]="true" optionValue="uuid">
                                </p-dropdown>
                            </div>
                        </div>
                    </div>
                </fieldset>
                <fieldset *ngIf="historie">
                    <legend>
                        <b>Informations d'identification</b>
                    </legend>
                    <div class="row">
                        <div class="col-md-4">
                            <div class="form-group">
                                <label>
                                    <b>{{ firstLevelLibelle
                                        }}<span class="text-danger">*</span></b>
                                </label>
                                <input type="text" formControlName="niveau_un_uuid" pInputText />
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label>
                                    <b>{{ secondLevelLibelle
                                        }}<span class="text-danger">*</span></b>
                                </label>
                                <input type="text" formControlName="niveau_deux_uuid" pInputText />
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label>
                                    <b>{{ thirdLevelLibelle
                                        }}<span class="text-danger">*</span></b>
                                </label>
                                <input type="text" formControlName="niveau_trois_uuid" pInputText />
                            </div>
                        </div>
                    </div>
                </fieldset>

                <fieldset *ngIf="selectedActionValue">
                    <legend>
                        <b>Demande</b>
                    </legend>
                    <div class="row">
                        <div class="col-md-4">
                            <div class="form-group">
                                <label><b>Nombre</b><span class="text-danger">*</span></label>
                                <input placeholder="nombre" formControlName="nb_demandes" type="number" pInputText />
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label>
                                    <b style="color: #000">Paiement
                                        <span class="text-danger">*</span></b>
                                </label>
                                <input type="file" style="
                                        padding: 0.6rem;
                                        border: 1px solid #000;
                                        border-radius: 0.3rem;
                                        color: #000;
                                    " (change)="
                                        onChangeFile(
                                            $event.target.files,
                                            'justificatif'
                                        )
                                    " accept="image/png,image/jpeg" />
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label>
                                    <b>Reçu de paiement
                                        <span class="text-danger">*</span></b>
                                </label>
                                <input type="file" style="
                                        padding: 0.6rem;
                                        border: 1px solid;
                                        border-radius: 0.3rem;
                                        color: #000;
                                    " (change)="
                                        onChangeFile(
                                            $event.target.files,
                                            'recu'
                                        )
                                    " accept="image/png,image/jpeg" />
                            </div>
                        </div>
                    </div>
                </fieldset>
            </div>
            <fieldset>
                <legend>
                    <b>Description de la Demande</b>
                </legend>
                <div class="row">
                    <div class="col-md-12">
                        <div class="form-group">
                            <input type="text" [(ngModel)]="selectedDescription" pInputText />
                        </div>
                    </div>
                </div>
            </fieldset>
        </div>
        <div class="submit-form">
            <div>
                <button pButton style="float: right; margin-top: 1rem" label="Soumettre" class="p-button-success"
                    [disabled]="
                        !adminForm ||
                        !selectedPiece ||
                        !selectedRecuPaiement ||
                        !selectedDescription ||
                        !adminForm.value.nb_demandes ||
                        !adminForm.value.niveau_un_uuid ||
                        !adminForm.value.niveau_deux_uuid ||
                        !adminForm.value.niveau_trois_uuid ||
                        !adminForm.value.usage_id ||
                        !adminForm.value.formule_uuid ||
                        listDemandes?.length === 0
                    " (click)="handleSaveMasse()"></button>
            </div>
        </div>
    </div>
</div> -->
