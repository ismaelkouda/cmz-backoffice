<p-table
    #dt
    [value]="newspapers()"
    [rowHover]="true"
    [rows]="(pagination$ | async)?.per_page"
    [globalFilterFields]="tableConfig.globalFilterFields"
    responsiveLayout="scroll"
    scrollable="true"
    scrollHeight="flex"
    data-testid="newspapers-table"
    role="grid"
    width="100%"
>
    <ng-template pTemplate="caption">
        <div class="container-table-header">
            <app-table-title
                [count]="(pagination$ | async)?.total"
                [perPage]="(pagination$ | async)?.per_page"
                [page]="(pagination$ | async)?.current_page"
                [totalPage]="(pagination$ | async)?.last_page"
            >
            </app-table-title>
            <div class="d-flex gap-2 align-items-center custom-header-actions mt-2 mt-md-0">
                <app-table-button-header
                    (export)="onExportExcel()"
                    (refresh)="onRefresh()"
                    [disabledButtonExport]="isLoading() || !hasData()"
                    [disabledButtonRefresh]="isLoading()"
                    [hiddenButtonOther]="false"
                    (other)="onAddClicked()"
                    [labelOther]="'MANAGEMENT.NEWSPAPERS.BUTTONS.ADD'"
                >
                </app-table-button-header>
                <app-search-table [dt]="dt" />
            </div>
        </div>
    </ng-template>
    <ng-template pTemplate="header">
        <tr role="row">
            @for (col of tableConfig.cols; track trackByColField($index, col)) {
                <th
                    [class]="col.class"
                    [style]="{
                        'min-width': col.width,
                        'width': col.width,
                        'text-align': 'center'
                    }"
                    role="columnheader"
                    scope="col"
                >
                    {{ col.header | translate }}
                </th>
            }
        </tr>
    </ng-template>
    <ng-template pTemplate="body" let-newspaper let-rowIndex="rowIndex">
        <tr
            role="row"
            [class.cursor-pointer]="!isLoading()"
            >
            @for (col of tableConfig.cols; track trackByColField($index, col)) {
                <td
                [class]="col.class"
                [style]="{
                    'min-width': col.width,
                    'width': col.width
                }"
                role="gridcell"
            >
            @switch (col.field) {
                @case ('__index') {
                    {{
                            ((pagination$ | async)?.current_page - 1 || 0) *
                                ((pagination$ | async)?.per_page || 0) +
                                rowIndex +
                                1
                        }}
                }

                    @case ('createdAt') {
                        <time [attr.datetime]="newspaper.createdAt">
                            {{ formatDate(newspaper.createdAt) }}
                        </time>
                    }

                    @case ('updatedAt') {
                        <time [attr.datetime]="newspaper.updatedAt">
                            {{ formatDate(newspaper.updatedAt) }}
                        </time>
                    }
                    
                    @case ('__action') {
                        <div class="action-group">
                            <button
                                type="button"
                                pButton
                                icon="pi pi-pencil"
                                (click)="onUpdateClicked(newspaper)"
                                [pTooltip]="getUpdateTooltip(newspaper)"
                                tooltipPosition="bottom"
                                [disabled]="isLoading()"
                                size="small"
                                class="action-btn"
                            ></button>
                            <button
                                type="button"
                                pButton
                                severity="danger"
                                icon="pi pi-trash"
                                (click)="onDeleteClicked(newspaper)"
                                [pTooltip]="getDeleteTooltip(newspaper)"
                                tooltipPosition="bottom"
                                [disabled]="isLoading()"
                                size="small"
                                class="action-btn" 
                            ></button>
                        </div>
                    }
                    
                    @default {
                        {{ newspaper[col.field] || '-' }}
                    }
            }
            </td>
            }
        </tr>
    </ng-template>

    <ng-template pTemplate="emptymessage">
        @if (!isLoading()) {
            <tr role="row" class="loading-table">
                <td [attr.colspan]="tableConfig.cols.length" role="gridcell">
                    <div class="empty-state text-center">
                        {{ 'NO_DATA_FOUND' | translate }}
                    </div>
                </td>
            </tr>
        }
        @if (isLoading()) {
            <tr role="row" class="loading-table">
                <td [attr.colspan]="tableConfig.cols.length">
                        <p-progressSpinner
                            class="posCenter"
                            [style]="{ width: '40px', height: '50px' }"
                            styleClass="custom-spinner"
                            strokeWidth="8"
                            fill="#EEEEEE"
                            animationDuration=".5s"
                        >
                        </p-progressSpinner>
                </td>
            </tr>
        }
    </ng-template>
</p-table>






